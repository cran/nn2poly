<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pablo Morala" />

<meta name="date" content="2024-01-17" />

<title>Classification example using tensorflow</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Classification example using
tensorflow</h1>
<h4 class="author">Pablo Morala</h4>
<h4 class="date">2024-01-17</h4>


<div id="TOC">
<ul>
<li><a href="#multiclass-classification-example" id="toc-multiclass-classification-example">Multiclass classification
example</a>
<ul>
<li><a href="#data-preparation" id="toc-data-preparation">Data
preparation</a></li>
<li><a href="#neural-network" id="toc-neural-network">Neural network</a>
<ul>
<li><a href="#build-and-train-the-nn" id="toc-build-and-train-the-nn">Build and train the NN</a></li>
<li><a href="#nn-predictions" id="toc-nn-predictions">NN
Predictions</a></li>
</ul></li>
<li><a href="#polynomial-representation" id="toc-polynomial-representation">Polynomial representation</a>
<ul>
<li><a href="#using-nn2poly" id="toc-using-nn2poly">Using
<code>nn2poly</code></a></li>
<li><a href="#obtaining-polynomial-predictions" id="toc-obtaining-polynomial-predictions">Obtaining polynomial
predictions</a></li>
<li><a href="#visualizing-the-results" id="toc-visualizing-the-results">Visualizing the results</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="multiclass-classification-example" class="section level1">
<h1>Multiclass classification example</h1>
<p>After showing how to use <code>nn2poly</code> in a regression setting
both in <code>vignette(&quot;nn2poly-01-introduction&quot;)</code> and
<code>vignette(&quot;nn2poly-02-supported-DL-frameworks&quot;)</code>, we will see
here a multiclass classification example using the iris dataset to
showcase how nn2poly obtains a polynomial for each class (or output
neuron).</p>
<p>In order to train our model we will use in this case the
<code>keras</code>/<code>tensorflow</code> framework, and we will
benefit from the provided support for it in <code>nn2poly</code> as we
saw in <code>vignette(&quot;nn2poly-02-supported-DL-frameworks&quot;)</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(nn2poly)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(keras)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># This sets all needed seeds</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>tensorflow<span class="sc">::</span><span class="fu">set_random_seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>First we load the <code>iris</code> dataset and scale the data to the
<span class="math inline">\([-1,1]\)</span> interval:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Change response to numeric. In this case, Species was already numeric,</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># but this step is needed if it is a factor variable.</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># Define dimension p (number of predictor variables)</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">dim</span>(iris)[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co"># Define objective classes</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>n_class <span class="ot">&lt;-</span> <span class="fu">max</span>(iris[,(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co"># Move objective classes from (1:3) to (0:2), needed for tensorflow</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>iris[,(p<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> iris[,(p<span class="sc">+</span><span class="dv">1</span>)] <span class="sc">-</span> <span class="dv">1</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Scale the data in the [-1,1] interval and separate train and test</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Only the predictor variables are scaled, not the response as those will be</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># the different classes.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>iris_x <span class="ot">&lt;-</span> iris[,<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>maxs <span class="ot">&lt;-</span> <span class="fu">apply</span>(iris_x, <span class="dv">2</span>, max)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>mins <span class="ot">&lt;-</span> <span class="fu">apply</span>(iris_x, <span class="dv">2</span>, min)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>data_x_scaled <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(iris_x, <span class="at">center =</span> mins <span class="sc">+</span> (maxs <span class="sc">-</span> mins) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">scale =</span> (maxs <span class="sc">-</span> mins) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_x_scaled, iris[,(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># Divide in train (0.75) and test (0.25)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fu">round</span>(<span class="fl">0.75</span> <span class="sc">*</span> <span class="fu">nrow</span>(data)))</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>train <span class="ot">&lt;-</span> data[index, ]</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>test <span class="ot">&lt;-</span> data[<span class="sc">-</span>index, ]</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>train_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train[,<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train[,(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>test_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test[,<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test[,(p<span class="sc">+</span><span class="dv">1</span>)])</span></code></pre></div>
</div>
<div id="neural-network" class="section level2">
<h2>Neural network</h2>
<p>In this section we will create and train (imposing weight
constraints) our original neural network that will be later explained by
<code>nn2poly()</code>.</p>
<div id="build-and-train-the-nn" class="section level3">
<h3>Build and train the NN</h3>
<p>First, we build the model.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>keras_model <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  tensorflow<span class="sc">::</span><span class="fu">set_random_seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">keras_model_sequential</span>()</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> <span class="dv">100</span>, <span class="at">activation =</span> <span class="st">&quot;tanh&quot;</span>, <span class="at">input_shape =</span> p)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> <span class="dv">100</span>, <span class="at">activation =</span> <span class="st">&quot;tanh&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> n_class, <span class="at">activation =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  nn</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="fu">keras_model</span>()</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co"># Impose weight constraints provided by nn2poly package</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="fu">add_constraints</span>(nn, <span class="at">constraint_type =</span> <span class="st">&quot;l1_norm&quot;</span>)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>nn</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; Model: &quot;sequential&quot;</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;  Layer (type)                       Output Shape                    Param #     </span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;  dense (Dense)                      (None, 100)                     500         </span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt;  dense_1 (Dense)                    (None, 100)                     10100       </span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt;  dense_2 (Dense)                    (None, 3)                       303         </span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; ================================================================================</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; Total params: 10903 (42.59 KB)</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; Trainable params: 10903 (42.59 KB)</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; Non-trainable params: 0 (0.00 Byte)</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; ________________________________________________________________________________</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: In this case the NN has a <em>linear</em> output with
the same number of neurons as the number of classes to predict (3
species, <code>n_class</code>). Then, the linear output will be
transformed into a <em>probability</em> to find the most probable class
but this step is done <em>after training</em>. Therefore, nn2poly will
be used to obtain a polynomial that approximates this <em>nn with linear
outputs</em> and then its results will also be transformed in
probabilities to predict the highest probability class.</p>
</blockquote>
<p>Then we compile and train the model, using a categorical crossentropy
loss and accuracy as the chosen metric.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">compile</span>(nn,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>        <span class="at">loss =</span> <span class="fu">loss_sparse_categorical_crossentropy</span>(<span class="at">from_logits =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>        <span class="at">optimizer =</span> <span class="fu">optimizer_adam</span>(),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>        <span class="at">metrics =</span> <span class="st">&quot;accuracy&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>history <span class="ot">&lt;-</span> <span class="fu">fit</span>(nn,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>               train_x,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>               train_y,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="dv">0</span>,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>               <span class="at">epochs =</span> <span class="dv">200</span>,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>               <span class="at">validation_split =</span> <span class="fl">0.3</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">plot</span>(history)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="nn-predictions" class="section level3">
<h3>NN Predictions</h3>
<p>In this case, to asses the NNs accuracy we have to transform their
output into a probability, which we will do by using
<code>layer_activation_softmax()</code> and then choosing the class with
highest probability with <code>k_argmax</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Define the model probability model using our previously trained nn</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>probability_model <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">nn</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">layer_activation_softmax</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">layer_lambda</span>(k_argmax)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># Obtain the predicted classes with the NN to compare them</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>prediction_NN_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(probability_model, test_x)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; 2/2 - 0s - 70ms/epoch - 35ms/step</span></span></code></pre></div>
<blockquote>
<p><em>Note</em>: As said before, <code>nn2poly()</code> will
approximate the linear output of the neural network, so we will need to
perform these transformation also in the polynomial predictions to
obtain a classification response.</p>
</blockquote>
<p>We can also compute the linear output of the model (before converting
it to a probability) and store it to compare with the polynomial output
later.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Also, the linear output can be predicted before the probability model</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>prediction_NN <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn, test_x)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 2/2 - 0s - 40ms/epoch - 20ms/step</span></span></code></pre></div>
<p>Finally We can use here a confusion matrix to visualize the results,
where we can see that that the NN correctly predicts almost all of the
classes in the test data:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Create a confusion matrix</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>cm <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(prediction_NN_class), <span class="fu">as.factor</span>(test_y))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>cm</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix and Statistics</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Prediction  0  1  2</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;          0 11  0  0</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;          1  0 11  1</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;          2  0  1 14</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Overall Statistics</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;                                           </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;                Accuracy : 0.9474          </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt;                  95% CI : (0.8225, 0.9936)</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;     No Information Rate : 0.3947          </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;     P-Value [Acc &gt; NIR] : 7.82e-13        </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;                                           </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;                   Kappa : 0.9203          </span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt;                                           </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;  Mcnemar&#39;s Test P-Value : NA              </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; Statistics by Class:</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt;                      Class: 0 Class: 1 Class: 2</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; Sensitivity            1.0000   0.9167   0.9333</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; Specificity            1.0000   0.9615   0.9565</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; Pos Pred Value         1.0000   0.9167   0.9333</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; Neg Pred Value         1.0000   0.9615   0.9565</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; Prevalence             0.2895   0.3158   0.3947</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; Detection Rate         0.2895   0.2895   0.3684</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; Detection Prevalence   0.2895   0.3158   0.3947</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; Balanced Accuracy      1.0000   0.9391   0.9449</span></span></code></pre></div>
</div>
</div>
<div id="polynomial-representation" class="section level2">
<h2>Polynomial representation</h2>
<div id="using-nn2poly" class="section level3">
<h3>Using <code>nn2poly</code></h3>
<p>After the NN has been trained, we can directly call
<code>nn2poly()</code> on the model, where we only need to choose the
value <code>max_order</code> which will limit the order of the computed
coefficients in the final polynomial. In this case we will set it as
<code>3</code>.</p>
<p>Note that in this case, as we have 3 output neurons, there will be 3
output polynomials. The polynomials will be stored in the same way as in
the regression case, in a list with labels and values, but in this case
the values will be a matrix with 3 rows, where each row will be the
polynomial obtained for each output neuron.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Polynomial for nn</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>final_poly <span class="ot">&lt;-</span> <span class="fu">nn2poly</span>(<span class="at">object =</span> nn,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                      <span class="at">max_order =</span> <span class="dv">3</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>final_poly</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; $labels</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; $labels[[1]]</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; $labels[[2]]</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; $labels[[3]]</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; $labels[[4]]</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; $labels[[5]]</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; $labels[[6]]</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; [1] 1 1</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; $labels[[7]]</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; $labels[[8]]</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; [1] 1 3</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; $labels[[9]]</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; [1] 1 4</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; $labels[[10]]</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; [1] 2 2</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; $labels[[11]]</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; [1] 2 3</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; $labels[[12]]</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; [1] 2 4</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; $labels[[13]]</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; [1] 3 3</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; $labels[[14]]</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; [1] 3 4</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; $labels[[15]]</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; [1] 4 4</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt; $labels[[16]]</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 1</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; $labels[[17]]</span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 2</span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; $labels[[18]]</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 3</span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a><span class="co">#&gt; $labels[[19]]</span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 4</span></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a><span class="co">#&gt; $labels[[20]]</span></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 2</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a><span class="co">#&gt; $labels[[21]]</span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3</span></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a><span class="co">#&gt; $labels[[22]]</span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 4</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a><span class="co">#&gt; $labels[[23]]</span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a><span class="co">#&gt; [1] 1 3 3</span></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a><span class="co">#&gt; $labels[[24]]</span></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a><span class="co">#&gt; [1] 1 3 4</span></span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a><span class="co">#&gt; $labels[[25]]</span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a><span class="co">#&gt; [1] 1 4 4</span></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a><span class="co">#&gt; $labels[[26]]</span></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a><span class="co">#&gt; [1] 2 2 2</span></span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a><span class="co">#&gt; $labels[[27]]</span></span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a><span class="co">#&gt; [1] 2 2 3</span></span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="co">#&gt; $labels[[28]]</span></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a><span class="co">#&gt; [1] 2 2 4</span></span>
<span id="cb9-89"><a href="#cb9-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-90"><a href="#cb9-90" tabindex="-1"></a><span class="co">#&gt; $labels[[29]]</span></span>
<span id="cb9-91"><a href="#cb9-91" tabindex="-1"></a><span class="co">#&gt; [1] 2 3 3</span></span>
<span id="cb9-92"><a href="#cb9-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-93"><a href="#cb9-93" tabindex="-1"></a><span class="co">#&gt; $labels[[30]]</span></span>
<span id="cb9-94"><a href="#cb9-94" tabindex="-1"></a><span class="co">#&gt; [1] 2 3 4</span></span>
<span id="cb9-95"><a href="#cb9-95" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-96"><a href="#cb9-96" tabindex="-1"></a><span class="co">#&gt; $labels[[31]]</span></span>
<span id="cb9-97"><a href="#cb9-97" tabindex="-1"></a><span class="co">#&gt; [1] 2 4 4</span></span>
<span id="cb9-98"><a href="#cb9-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-99"><a href="#cb9-99" tabindex="-1"></a><span class="co">#&gt; $labels[[32]]</span></span>
<span id="cb9-100"><a href="#cb9-100" tabindex="-1"></a><span class="co">#&gt; [1] 3 3 3</span></span>
<span id="cb9-101"><a href="#cb9-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-102"><a href="#cb9-102" tabindex="-1"></a><span class="co">#&gt; $labels[[33]]</span></span>
<span id="cb9-103"><a href="#cb9-103" tabindex="-1"></a><span class="co">#&gt; [1] 3 3 4</span></span>
<span id="cb9-104"><a href="#cb9-104" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-105"><a href="#cb9-105" tabindex="-1"></a><span class="co">#&gt; $labels[[34]]</span></span>
<span id="cb9-106"><a href="#cb9-106" tabindex="-1"></a><span class="co">#&gt; [1] 3 4 4</span></span>
<span id="cb9-107"><a href="#cb9-107" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-108"><a href="#cb9-108" tabindex="-1"></a><span class="co">#&gt; $labels[[35]]</span></span>
<span id="cb9-109"><a href="#cb9-109" tabindex="-1"></a><span class="co">#&gt; [1] 4 4 4</span></span>
<span id="cb9-110"><a href="#cb9-110" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-111"><a href="#cb9-111" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-112"><a href="#cb9-112" tabindex="-1"></a><span class="co">#&gt; $values</span></span>
<span id="cb9-113"><a href="#cb9-113" tabindex="-1"></a><span class="co">#&gt;              [,1]         [,2]         [,3]</span></span>
<span id="cb9-114"><a href="#cb9-114" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.04067109  2.838697004 -2.366766912</span></span>
<span id="cb9-115"><a href="#cb9-115" tabindex="-1"></a><span class="co">#&gt;  [2,] -1.01692952  0.922284435  0.306762048</span></span>
<span id="cb9-116"><a href="#cb9-116" tabindex="-1"></a><span class="co">#&gt;  [3,]  3.82618130 -1.532152815 -2.683000514</span></span>
<span id="cb9-117"><a href="#cb9-117" tabindex="-1"></a><span class="co">#&gt;  [4,] -4.86343269 -0.367029700  5.201883882</span></span>
<span id="cb9-118"><a href="#cb9-118" tabindex="-1"></a><span class="co">#&gt;  [5,] -6.05908248 -2.026009803  7.701675045</span></span>
<span id="cb9-119"><a href="#cb9-119" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.02216647 -0.068650500  0.031318449</span></span>
<span id="cb9-120"><a href="#cb9-120" tabindex="-1"></a><span class="co">#&gt;  [7,] -0.09821698  0.115922745  0.007638440</span></span>
<span id="cb9-121"><a href="#cb9-121" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.08146315 -0.072443601 -0.025525980</span></span>
<span id="cb9-122"><a href="#cb9-122" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.04337399 -0.019371395 -0.029198248</span></span>
<span id="cb9-123"><a href="#cb9-123" tabindex="-1"></a><span class="co">#&gt; [10,]  0.08763212 -0.122314949  0.007196786</span></span>
<span id="cb9-124"><a href="#cb9-124" tabindex="-1"></a><span class="co">#&gt; [11,] -0.13090934  0.160297202  0.008898167</span></span>
<span id="cb9-125"><a href="#cb9-125" tabindex="-1"></a><span class="co">#&gt; [12,] -0.03982065  0.118363240 -0.047742059</span></span>
<span id="cb9-126"><a href="#cb9-126" tabindex="-1"></a><span class="co">#&gt; [13,] -0.03990296 -0.186114002  0.182448046</span></span>
<span id="cb9-127"><a href="#cb9-127" tabindex="-1"></a><span class="co">#&gt; [14,] -0.22518863 -0.383706458  0.517483976</span></span>
<span id="cb9-128"><a href="#cb9-128" tabindex="-1"></a><span class="co">#&gt; [15,] -0.21539519 -0.340739130  0.476053215</span></span>
<span id="cb9-129"><a href="#cb9-129" tabindex="-1"></a><span class="co">#&gt; [16,]  0.01640856 -0.015861053 -0.004179781</span></span>
<span id="cb9-130"><a href="#cb9-130" tabindex="-1"></a><span class="co">#&gt; [17,] -0.08649215  0.054035395  0.045407899</span></span>
<span id="cb9-131"><a href="#cb9-131" tabindex="-1"></a><span class="co">#&gt; [18,]  0.08657797 -0.020808458 -0.071458194</span></span>
<span id="cb9-132"><a href="#cb9-132" tabindex="-1"></a><span class="co">#&gt; [19,]  0.10626455  0.016833308 -0.120917295</span></span>
<span id="cb9-133"><a href="#cb9-133" tabindex="-1"></a><span class="co">#&gt; [20,] -0.09226002  0.058721711  0.047211597</span></span>
<span id="cb9-134"><a href="#cb9-134" tabindex="-1"></a><span class="co">#&gt; [21,] -0.12782353  0.099224893  0.053681832</span></span>
<span id="cb9-135"><a href="#cb9-135" tabindex="-1"></a><span class="co">#&gt; [22,] -0.14300636  0.061378209  0.099556359</span></span>
<span id="cb9-136"><a href="#cb9-136" tabindex="-1"></a><span class="co">#&gt; [23,]  0.08681554 -0.019495659 -0.072698532</span></span>
<span id="cb9-137"><a href="#cb9-137" tabindex="-1"></a><span class="co">#&gt; [24,]  0.07906020 -0.071096510 -0.027609755</span></span>
<span id="cb9-138"><a href="#cb9-138" tabindex="-1"></a><span class="co">#&gt; [25,]  0.10751970  0.019949727 -0.124596164</span></span>
<span id="cb9-139"><a href="#cb9-139" tabindex="-1"></a><span class="co">#&gt; [26,] -0.12832404  0.057077780  0.086244551</span></span>
<span id="cb9-140"><a href="#cb9-140" tabindex="-1"></a><span class="co">#&gt; [27,]  0.31410761 -0.112571487 -0.233324113</span></span>
<span id="cb9-141"><a href="#cb9-141" tabindex="-1"></a><span class="co">#&gt; [28,]  0.39822386 -0.072171099 -0.351003640</span></span>
<span id="cb9-142"><a href="#cb9-142" tabindex="-1"></a><span class="co">#&gt; [29,]  0.32366110 -0.115551628 -0.240170974</span></span>
<span id="cb9-143"><a href="#cb9-143" tabindex="-1"></a><span class="co">#&gt; [30,] -0.64179985  0.150429244  0.539640723</span></span>
<span id="cb9-144"><a href="#cb9-144" tabindex="-1"></a><span class="co">#&gt; [31,]  0.40593582 -0.069258417 -0.360602426</span></span>
<span id="cb9-145"><a href="#cb9-145" tabindex="-1"></a><span class="co">#&gt; [32,]  0.17561230  0.009076263 -0.185280705</span></span>
<span id="cb9-146"><a href="#cb9-146" tabindex="-1"></a><span class="co">#&gt; [33,]  0.51767960  0.109300583 -0.609898697</span></span>
<span id="cb9-147"><a href="#cb9-147" tabindex="-1"></a><span class="co">#&gt; [34,]  0.51398607  0.101899652 -0.600694175</span></span>
<span id="cb9-148"><a href="#cb9-148" tabindex="-1"></a><span class="co">#&gt; [35,]  0.34526975  0.146409617 -0.461815984</span></span>
<span id="cb9-149"><a href="#cb9-149" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-150"><a href="#cb9-150" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb9-151"><a href="#cb9-151" tabindex="-1"></a><span class="co">#&gt; [1] &quot;nn2poly&quot;</span></span></code></pre></div>
</div>
<div id="obtaining-polynomial-predictions" class="section level3">
<h3>Obtaining polynomial predictions</h3>
<p>As said before, the obtained polynomial represents the neural network
before including the softmax function and computing the class assigned
to each observation. Then, we need to define again a keras sequential
model that includes the class computation from the polynomial output.
This polynomial output is obtained with <code>predict()</code> used on
the <code>nn2poly()</code> output, in this case in matrix form, as the 3
polynomials are evaluated at the same time:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># Obtain the predicted values for the test data with our Polynomial Regression</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>prediction_poly_matrix <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> final_poly, <span class="at">newdata =</span> test_x)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># Define probability model with keras for the polynomial outputs</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>probability_poly <span class="ot">&lt;-</span> <span class="fu">keras_model_sequential</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">layer_activation_softmax</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="fu">layer_lambda</span>(k_argmax)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co"># Class prediction with the polynomial outputs</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>prediction_poly_class <span class="ot">&lt;-</span> <span class="fu">predict</span>(probability_poly,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                                 prediction_poly_matrix)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; 2/2 - 0s - 121ms/epoch - 60ms/step</span></span></code></pre></div>
</div>
<div id="visualizing-the-results" class="section level3">
<h3>Visualizing the results</h3>
<p>With the polynomial predictions, there are two options. We can
represent in a diagonal line the linear outputs obtained directly from
the polynomial and NN predictions, or compare the assigned classes after
employing the probability models. Please note here that we compare the
predictions (linear and classes) of the polynomials with the NN
predictions and not the original data, as <code>nn2poly</code>s goal is
to faithfully represent the NN behavior independently of how well the NN
predicts.</p>
<p>First, lets observe the confusion matrix for the assigned
classes:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># Confussion matrix between NN class prediction and polynomial class prediction</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>cm_poly <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(prediction_NN_class), <span class="fu">as.factor</span>(prediction_poly_class))</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>cm_poly</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; Confusion Matrix and Statistics</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;           Reference</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; Prediction  0  1  2</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;          0 11  0  0</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;          1  0 12  0</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;          2  0  0 15</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Overall Statistics</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;                                      </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt;                Accuracy : 1          </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;                  95% CI : (0.9075, 1)</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;     No Information Rate : 0.3947     </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;     P-Value [Acc &gt; NIR] : 4.568e-16  </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;                                      </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;                   Kappa : 1          </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;                                      </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt;  Mcnemar&#39;s Test P-Value : NA         </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; Statistics by Class:</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt;                      Class: 0 Class: 1 Class: 2</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; Sensitivity            1.0000   1.0000   1.0000</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; Specificity            1.0000   1.0000   1.0000</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; Pos Pred Value         1.0000   1.0000   1.0000</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; Neg Pred Value         1.0000   1.0000   1.0000</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; Prevalence             0.2895   0.3158   0.3947</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt; Detection Rate         0.2895   0.3158   0.3947</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; Detection Prevalence   0.2895   0.3158   0.3947</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; Balanced Accuracy      1.0000   1.0000   1.0000</span></span></code></pre></div>
<p>The polynomials obtain the same results as the original NN.</p>
<p>Then, we can extract a diagonal plot for each of the polynomials
obtained, in total <span class="math inline">\(3\)</span> diagonal
plots.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">print</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_NN[,i],</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                  <span class="at">y_axis =</span>  prediction_poly_matrix[,i],</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">&quot;NN prediction&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">&quot;Polynomial prediction&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>        )</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABPlBMVEUAAAAAADoAAGYzMzM6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmADpmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkLZmkNtmtrZmtv9ubo5ubqtujo5ujqtuq8iObm6Obo6ObquOjo6OjquOq+SOyP+QOgCQOjqQOmaQZjqQZmaQZpCQkGaQkJCQkNuQtraQttuQtv+Q29uQ2/+rbm6rbo6rjm6rjo6rjquryP+r5P+2Zjq2Zma2kDq2kGa2tma2tpC2tra2ttu229u22/+2///Ijm7Ijo7IjqvIq47I5P/I///bkDrbkGbbkJDbtmbbtpDbtrbbttvb27bb29vb2//b/9vb///kq27kq47kyI7kyKvk5Mjk///r6+v/AAD/tmb/tpD/yI7/25D/27b/5Kv/5Mj//7b//8j//9v//+T////JB2WVAAAACXBIWXMAAAsSAAALEgHS3X78AAAVDklEQVR4nO2djXsU1RXG0yYgaLUiUBUFUUsFW61R1ICUVEEh0mKNBtQwqUhhd/7/f6D7kY+duTM7M3fOe8+Ze9/7PEn0hnffs+eXubs7c+eclZwjybGiHQCHziD4RAfBJzoIPtFRD/5Rh9HpH/trwkhij4zgdW0I3pok9sgygle10Yos4xGva6MTWZZxqVe2UYkse8TXeG0bjciy2QzBq9ooRJbNZwhe1SZ8ZNn+DMGr2gSPLDuYIXhVm9CRZYczBK9qEziy7GiG4FVtwkaWLcwQvKpN0MiyxRmCV7UJGVlWmCF4VZuAkWXFGYJXtQkXWVaaIXhVm2CRZeWZBvAccYyseppHvJZNgMhWVpx1/hGXem0bfGQrk5G5EoLXtQkCPquQELyuTYilPquSELyuTYDIskoJweva4CPLqiUEr2uDjizLaiQEr2sDjuxw24X7IASvaoON7GjbhfsgBK9qA41sYduF+yAEr2qDjGxx24X7IASvagOMrLDtwn0Qgle1wUVW3HbhPgjBq9rAIittu3AfhOBVbVCRlbdduA9C8Ko2oMicbRfugxC8qg0mMufyO8Fbs4FEVrHtwp0heFUbRGQud4I3ZwOIrII7wZuzkY+sijvBm7MRj6ySO8Gbs5GOrJo7wZuzEY6shjvBm7ORjayOO8GbsxGNrJY7wZuzEYwsq+dO8OZs5CJbgp3g7dmIRbaUO8Gbs5GKbDl3gjdnIxRZA3eCN2cjE1kTd4I3ZyMSWSN3gjdnIxFZM3eCN2cjEFkL7gRvzqZ/ZG24E7w5m96RteJO8OZs+kbWjjvBm7PpGVlL7gRvzqZfZG25E7w5m16RteZO8OZs+kTWnjvBm7PpEVkH7gRvzsYzspWVTtwJ3pyNX2SzapX9bAhe18YXfLbS06YW/IN3Cd6mZKLJOnLvAP7JeYI3KnmUd1vmq21qwI8/+2kKfnW19jWAQ23UNB3wGQ74hxu/8og3KqkoPu9hUw1+fOfi+dd3Cd6ipKr4vIdNzRGf5zzibUoqi8972NSC3x/9Hh2iSRp8dfF5DxuC17XpKKkpPu9hQ/C6Nt0kdcXnPWwIXtemkyQTtCF4XZsukvquAx42BK9r00GypOuAhw3B69q0lyzrOuBhQ/C6Nq0lS7sOeNgQvK5NW8nyrgMeNgSva9NS0tB1wMOG4HVt2kmaug542BC8rk0rSWPXAQ8bgte1aSNp7jrgYUPwujYtJC26DnjYELyuTaOkonodwSMlFiKr2T1P8EiJgcjqds8TPFJiILK63fMEj5RYiKxm9zzBIyUGImtffN7DhuB1bZZIOhSf97AheF2bekmX4vMeNgSva1Mr6VR83sOG4HVt6iTLbo8jeKREN7KOXQc8bAhe16Za0rXrgIcNwevaVEo6dx3wsCF4XZsqSfeuAx42BK9rUyHx6DrgYUPwujauxKfrgIeE4HVtHIlX1wEPCcHr2pQlfl0HPCQEr2tTknh2HfCQELyuTVHi23XAQ0LwujaLkmXNYQVt9mcIXtVmQdKj+LyHhOB1bY4kfYrPe0gIXtfmUNKr+LyHhOB1bQ4kR9xXGsvUEjxSEjayRe6N5AkeKQka2cI6T/DKkpCRFV7fudTrSgJG1rUKOcEjJeEi61x9nuCRkmCRdVznfW2cmQbwHOBR6DowfWcX1J1HvJZNcZ1v8Zbez4ZLvTGbcrcJO0t9v0eHaCIC79VtguChkhA2ft0mCB4qCWDj2W2C4KESvI1vtwmCh0rgNt7dJggeKkHb+HebIHioBGtzuL2O4K1JcDaF6nUEb00CsylWryN4axKQzfSk7GIVM4K3JsHYlLnPJK3O03ayaSEh+KA2TpXSvO2VmU42LSQEH9amXJ2W4K1J5G1meKuaDnCptyQRt5kd2BJNBwgeKoGAF2k6QPBQCWKpr9hWSfDWJAAboW4TBA+VyNtIdZsgeKhE3KZ6+zzBW5NI29TcNkHw1iTCNjXcu36Eb7JpLyH4IDa13H3IEzxSImpTd3scwduTSNrU3xbJpd6cRNBGuNsEwUMlYjbLq9cRvDWJlI180wGCh0okbGqaAvd0IXioRMCmrilwTxeCh0pEwNc0h+3nQvBQiYRNM3eCNycRsAE1HSB4qKS/TavT8wRvTdLbpt3peYK3Julr0/L0PMFbk/S0aXt6nuCtSfrZILtNEDxU0ssG2m2C4KESX5vpSl7NvfISLMFbk3jaVN82MR3Vmy4I3prEH3ynbVYEb03ivdTXvr5zqe+psQ2+Y/V5a+DHn75xl+A9JAG6TUDBP9x49tZunq+u1i4FHOUxLTWfNf8zU8Nd6sd33pn9BP8lRnTE17+fl3Tx1HR4jf/l7V2C7zIm2LtzNwf+56389gbBdxrZitXIOoB/cuHqm1zqOw2/4vPWwB8OcEDxgK8uPo/oGknwUElHTXXx+fnZumX0Cd6apJumpvj8DPzSOyMJ3pqkk6a2+Pz8gCd4EY098A3F57nUy2jMgT/8+G4usiUSgu+t6dV1gOCtSVpo5kt4v64DBG9N0qyZv2lbPE2bH/1KzEVGQ/CCGrcqcb74GyEXGQ3BS2qc298JHqoxA97ZdsGlHqqxA76q64C8i4SG4CU1El0HCN6apFkj0nWA4K1JGjUyXQcI3pqkSSPUdYDgrUmWa6q311mIrK2E4H00csXnCd6aZJmmbjetfmTtJQTfXVO7i1o9sg4Sgu+kqb/73dOG4K1JKjUNd8sQPFSjC164+DzBW5PULPXSxecJ3pqkWrP87jiCh2oU0yvfdYDgrUmqNICuAwRvTVKhQXQdsAJ+9N7a2rFbBF+lab77fcDgH/+dR3yNpkXVgwGDf3ple/sHgq/QgLoOWAE/2rz5wT93CN7RtKpyMmTwl069fJJHvKNpV91mwOCnr/H3+OaurGlZ1WjI4E/vjC4TfElTwV2qPqkV8Pn9F4+tc6kvaiq5C1UkNgN+m+/qFzSzy+9V63xs4Ld/3Nzc5Lv6A82Sy++RLfW/3TizufkXvsbva7oWKR0u+NEU/Jdc6g80bbnvH//DBZ/n19f/fZbgDzStuc/JDxg8P8cvatqu8zGA5+f4I0371/cIlvr7p175KueYjqE1HfAZ/BzvjjDF540c8fwcfzgys5EhwH+xNhnHE3+Nn71gZxYjk7QpLfWPJ5/l/pU2+IMqZvYiE7Upgz+Tp/6u/uA8rb3IRG3Kb+7uv3ii8K4eHJDF9O6fpzUYmaRNCfzovbW/nkwcfF3XAWkbXwnozN299XvraYOv7Toga+MtAZ25u/FRulfn9t/Po216SjCv8Y9LZ+7AAZlKb7EqsaXIADYl8L99mBcHOCBT6S3uu7AUGcCmBP7pKymfsi3suzAVmbxN+V395s2ET9kWtteZikzepgz+0nMvP5/qEV9dfF7cpq8E9HEuz1P9OFdXfF7YprcE9Rr//ZUvd1IEr1N83gr40eZ0fJkgeKXi81bAOwMckJn0ahWfJ3g9SU21SgORIW2K4Efb6W29qrtdRj8yqE0R/Peb6W29qrtdRj8yqE35zd2ltbXfJ3aRpuZ2GQORIW1K4KeXZVPbeqXadcAM+LN7ryZ2Ake364AV8Pl3P15P69455a4DZsCn9q5eu+uAEfDJ3VCh3nXACPjZIZ/QEa/fdcAK+McvnTr1SjJHvIGuA2bAp1TL1kLXASvgR39Oonp1YTstzgYj4RHvLSlup4XZgCQQ8GlstpyenjfSdcAK+ESqV7epZpUY+DSqV9spPm8FfBpVrwwVnzcDPoWqV5aKz1sBn0L1alPF562AT6ALVdtqVmmBj/9zfOsqZmmBj74LVfvqdWmBH0V8WbZmG7W0DVyCWepPFYqWxwR+SdcBSRu8BPOufvK2/vQPsYI32HXADPjRjRfP3DgbI/jWXQd62sAlmKV+WgFn9LcowXesSpwU+JhvoepajTop8N9v7l+dG18993lc4DtXIU8K/OHVuQcb40+28nx1NY9kpNB1wGNUXJ179tbu9Af4LzHUcWW264CVI/7w6tz44408HvAe3BMDf3B17tmFu3k84H26TaQF/r9ra/OLsrfPXXw7jqV+tr3OZGS+EgT467eeni6++oMDgudqwn3FZmTeEoJvMybcCb4Z/LUPbh6P6+rcjLvJyLwloBM4cV2W9W86kBZ4d4ADAueqR9MBgocGhM1Vn6YDBA8NCJqrXk0HCB4aEDJX/ZoOEDw0IGCuejYdIHhoQLhcFU7Pm4qsr4Tgl43e3SYIHhoQKlf9u00QPDQgUK4Euk0QPDQgTK4kuk0QPDQgSK5Euk0QPDQgRK5kuk0QPDQgQK6Euk0QPDQg+VxJdZsgeGhA4rkS6zZB8NCAhHNVV71OPzJBCcEXx7JilQTvzsQCfuld0ATvzsQDfrqdVs6F4KEBCeZqCXeCjxi8dNMBgocGJJYr8aYDBA8NSCpX8k0HCB4akFCuAE0HCB4akMyTQDQdIHhoQCJPovnud4J3Z4YPHtNtguChAQk8CVC3CYKHBtT/SaC6TRA8NKDeTwLWbYLgoQH1fRK4bhMEDw2o35NoXZ2W4N2ZAYOflzkBuRA8NKBeTyJbmfUKxbgQPDSgPk8im/UeaEWe4N2ZwYKfvb4TvK9kqOAPtlVyqfeUDBQ8vukAwUMD8nwSAZoOEDw0IL8nEaLpQOrgLQ42HRAbgzriwzQdSP2IBwfkofEpPk/w7szQwHsVnyd4d2Zg4LNhpRchSRJ85mdD8O7MoMBnnjYE784MCXzma0Pw7syAwPt3HSB4d2Y44Ht0HSB4d2Yo4I+2WQ0pvQhJWuAXtlkNKb0ISVrgs8MdF2332fm49NQQvLgme3TE3YM8wbszgwC/cF2G4BMCX7gex6U+FfDlqoVDSi9Ckgp4ieLzBO/OWAcvUnye4N0Z4+Blis8TvDtjG7xQ8XmCd2dMg5cqPk/w7oxl8GLF5wnenTEMXq74PMG7M3bB122jHlJ6EZLYwUt2HSB4d8YqeNGuAwTvzhgFv+R2mSGlFyGJGvyy26SGlF6EJGbw0l0HCN6dsQhevOsAwbszBsE3VDEbUnoRkmjBZw2bbIaUXoQkVvBZ0+6qIaUXIYkU/PT1nUs93sYaeEzXAYJ3Z0yBr2sK3NeG4N0ZS+BhxecJ3p0xBB5XfJ7g3Rk74IHF5wnenTEDvnUVsyGlFyGJDHz76nVDSi9CEhf4DlULh5RehCQq8F2qVQ4pvQhJTOA7VSkdUnoRkojAd6tOO6T0IiTxgMd3HSB4d0YffICuAwTvztSB/2YrEPgQXQcI3p2pBj+++toU/Opq7VIgNdh1QHO44He/3pr9B/gvMVDXAR7x7kw1+DwPAz5Q1wGCd2dUwYfqOkDw7owm+GBdBwjenakDvz+QAYXrOkDw7owe+IBdBwjendECn4XsOkDw7owS+LDF5wnendEBH7j4PMG7Myrgj07bRJ5ehGTA4BdO10WeXoRkuOAXT9NGnl6EZLDgC6fnI08vQjJU8FnhpsjI04uQDBR8VmwyEXl6EZJhgp/fBU3wPSSDBD9/fedS30cyRPBaXQcI3p0JCV6t6wDBuzMBwet1HSB4dyYceMWuAwTvzgQDr9l1gODdmVDgVbsOELw7Ewi8btcBgndnwoBX7jpA8O5MEPDaXQcI3p0JAH5Z9brI04uQDAa8geLzBO/OwMFbKD5P8O4MGnzDXZGRpxchGQb4prthI08vQjII8I13QUeeXoRkCOCb736PPL0IyQDAmyk+T/DuDBC8neLzBO/O4MC3qnISeXoREuvgLXUdIHh3BgXeVNcBgndnQOBtdR0geHcGA95Y1wGCd2cg4K11HSB4dwYB3lzXAYJ3ZwDg7XUdIHh3Rh68wa4DBO/OiIO32HWA4N0ZafAmuw4QvDsjC75Vc9jlERmRxB6ZLPjuRcgjTy9CEgZ8p8GmA0MbMke8R9OB2I8rhMTcUu/TdCD29CIk1sB7NR2IPb0IiTHwfk0HYk8vQmILvGfTgdjTi5CYAu/bdCD29CIklsB7Nx2IPb0IiSHwmXdAsacXIbEDvke3idjTi5CYAd+n20Ts6UVIrIDv1W0i9vQiJEbA9+s2EXt6ERIb4Ht2m4g9vQiJCfB9u03Enl6ExAL44vU4pjeIxAD40nVYpjeIRB98+fo70xtEog3+cHvdYb8JpjeIRBn84eF+1GGG6Q0i0QV/tMwTfGCJKvjFl3cu9WElmuDFmg7Enl6ERBG8XNOB2NOLkOiBF2w6EHt6ERI18JJNB2JPL0KiBV606UDs6UVIlMDLNh2IPb0IiQ74ZbdJMb1BJCrgpbtNxJ5ehEQDvHi3idjTi5AogJfvNhF7ehGS8OAB3SZiTy9CEhw8ottE7OlFSEKDh3SbiD29CElg8JhuE7GnFyEJC77A/fBCbO+AYk8vQhIUfIl7NXmmN4gkJPjiOk/wqpJw4J2qhVzqNSXBwCObDsSeXoQkFHho04HY04uQBAKPbToQe3oRkjDgwU0HYk8vQqJxdU48oNjTi5AQPFQSe2QEr2tjDfz4zmt3Cd6mBAr+4bvjz3YJ3qQECv72Rv71Vp6vrta+BnDEMBzwE+pT8DziDUqwS/3G+FOCtymBgv/fhavv5ARvUsKPc1BJ7JERvK4NwVuTxB4ZwevaELw1SeyREbyujVnw6BHm1GCgE5DDsyH4RG0IPlEbPfAcqoPgEx0En+gg+ESHHvhvtvAe46vnPse75ONP37gbwCbPH7wr9lBa4MdXX9vCuzzYGH8SwObhxrO3dvE2+ZPzEYDfne/zQY8wRMZ33gnh8tlPwwef50HAjz/eCOCS57+8HeDv6+HGrwTfbjy7EOS19+et6R5V9BjfuXj+dbG/r7jB3z53McSh+OTC1TfxLpMRxRHPoToIPtFB8IkOgk90EHyiIzHwey/k+fX1+ffSr0ZXbsymRj/cK/8qxpEa+N+t59fW59+n/789+dqZsJ7w/vHKzpR6vvdqPvs5/2W0IzXwf/rjzgT87Huef3vi5okvnvtw78Q/Tu+dvnH8xvr0v759YfbzxBeTrx3teHEjNfCv7r0wAT/7nueTNf3aqcnXmc1Lx25Nl/rrt6b/5N705+QXoysEH8uYrOPX1tbn32fgr78/+fpo+7vL++BH/yH4GMcE+dM/rM+/T5b6Y5efn8B//NL7Jydfk6X+8Uvvnd07fnn68+Q9go92JPH2vWYkDf7+V9oR6I2kwac8CD7RQfCJDoJPdBB8ouP/5qbFX8djVY0AAAAASUVORK5CYII=" /><img src="data:image/png;base64,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" /></p>
<p>We can observe how all the polynomials obtain quite similar
predictions to their equivalent NN predictions.</p>
<p>We can also plot the <span class="math inline">\(n\)</span> most
important coefficients in absolute value to compare which variables or
interactions are more relevant in each polynomial. In this case, we will
have 3 plots for each NN again, one per polynomial at each output
neuron. In this case, the obtained coefficients will represent the most
important variables when assigning the probability to be in each
class.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(final_poly, <span class="at">n =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<blockquote>
<p><em>Note</em>: The coefficients values are not in the same scale as
the original polynomial due to the fact that we have scaled all the data
before training, even the response variable Y. Furthermore, as data has
been scaled to the <span class="math inline">\([-1,1]\)</span> interval,
interactions of order 2 or higher would usually need a higher absolute
value than the lower order coefficients to be more relevant</p>
</blockquote>
<p>Finally, the problem with Taylor expansion can be checked with the
following plots, where each layer is represented with their activation
function, its Taylor expansion, the error and also the density of the
activation potentials that the activation functions receives at that
layer.</p>
<p>It can be clearly seen with the activation potentials density, in
green, that it is kept close to zero, thus having an accurate Taylor
expansion around zero at each hidden layer.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_taylor_and_activation_potentials</span>(<span class="at">object =</span> nn,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                                                <span class="at">data =</span> train,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                                                <span class="at">max_order =</span> <span class="dv">3</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                                                <span class="at">constraints =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<pre><code>#&gt; 
#&gt; [[2]]</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<pre><code>#&gt; 
#&gt; [[3]]</code></pre>
<p><img src="data:image/png;base64,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" /></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
