<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pablo Morala" />

<meta name="date" content="2024-01-17" />

<title>Supported DL frameworks</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Supported DL frameworks</h1>
<h4 class="author">Pablo Morala</h4>
<h4 class="date">2024-01-17</h4>


<div id="TOC">
<ul>
<li><a href="#data-generation" id="toc-data-generation">Data
generation</a></li>
<li><a href="#supported-frameworks-examples" id="toc-supported-frameworks-examples">Supported frameworks examples</a>
<ul>
<li><a href="#kerastensorflow" id="toc-kerastensorflow"><code>keras</code>/<code>tensorflow</code></a>
<ul>
<li><a href="#model-definition" id="toc-model-definition">Model
definition</a></li>
<li><a href="#training" id="toc-training">Training</a></li>
<li><a href="#nn-predictions" id="toc-nn-predictions">NN
predictions</a></li>
<li><a href="#using-nn2poly" id="toc-using-nn2poly">Using
nn2poly</a></li>
</ul></li>
<li><a href="#luztorch" id="toc-luztorch"><code>luz</code>/<code>torch</code></a>
<ul>
<li><a href="#data-loader-for-torch" id="toc-data-loader-for-torch">Data
loader for <code>torch</code></a></li>
<li><a href="#model-definition-1" id="toc-model-definition-1">Model
definition</a></li>
<li><a href="#training-1" id="toc-training-1">Training</a></li>
<li><a href="#nn-predictions-1" id="toc-nn-predictions-1">NN
predictions</a></li>
<li><a href="#using-nn2poly-1" id="toc-using-nn2poly-1">Using
nn2poly</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<p>In this vignette we will explore the supported deep learning
frameworks in <code>nn2poly</code> and how can they be used. Currently
supported frameworks are <code>keras</code>/<code>tensorflow</code> and
<code>luz</code>/<code>torch</code>. The benefit of using them is that
we provide an easy to use implementation of the weight constraints
needed during training to avoid problems in the Taylor expansion carried
out by <code>nn2poly</code>. Furthermore, models created with these
frameworks are directly supported by the <code>nn2poly()</code>
function, allowing then to skip the need to manually create an object
with weights and activation functions as explained in
<code>vignette(&quot;nn2poly-01-introduction&quot;)</code>.</p>
<p>If you are interested in having support for another deep learning
framework, please open an issue in our <a href="https://github.com/IBiDat/nn2poly">GitHub repo</a>!</p>
<blockquote>
<p><em>Note</em>: Using the provided constraints when training a model
increases the number of needed epochs to converge, which is an expected
trade off between learning speed and control over the weights for easier
explainability.</p>
</blockquote>
<div id="data-generation" class="section level1">
<h1>Data generation</h1>
<p>As our goal here is to show how to impose the needed constraints for
each framework, we will replicate the polynomial data generation from
<code>vignette(&quot;nn2poly-01-introduction&quot;)</code> and solve later the
same regression problem with the different deep learning frameworks.
Refer to that vignette for more details.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(nn2poly)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<p>Create the polynomial <span class="math inline">\(4x_1 - 3
x_2x_3\)</span>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>polynomial <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>polynomial<span class="sc">$</span>labels <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>polynomial<span class="sc">$</span>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
<p>Generate the data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Define number of variables and sample size</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Predictor variables</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n_sample,p)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  X[,i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_sample,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># Response variable + small error term</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>Y <span class="ot">&lt;-</span> nn2poly<span class="sc">:::</span><span class="fu">eval_poly</span>(<span class="at">poly =</span> polynomial, <span class="at">newdata =</span> X) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  stats<span class="sc">::</span><span class="fu">rnorm</span>(n_sample, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># Store all as a data frame</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(X, Y))</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt;           V1           V2         V3          Y</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#&gt; 1  1.3709584  1.029140719  2.3250585 -1.7547416</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">#&gt; 2 -0.5646982  0.914774868  0.5241222 -3.7107357</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt; 3  0.3631284 -0.002456267  0.9707334  1.3609395</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; 4  0.6328626  0.136009552  0.3769734  2.4608270</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt; 5  0.4042683 -0.720153545 -0.9959334 -0.6141076</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt; 6 -0.1061245 -0.198124330 -0.5974829 -0.7455793</span></span></code></pre></div>
<p>Scale the data to have everything in the <span class="math inline">\([-1,1]\)</span> interval and divide it in train
and test.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Data scaling to [-1,1]</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>maxs <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, max)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>mins <span class="ot">&lt;-</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, min)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(data, <span class="at">center =</span> mins <span class="sc">+</span> (maxs <span class="sc">-</span> mins) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">scale =</span> (maxs <span class="sc">-</span> mins) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co"># Divide in train (0.75) and test (0.25)</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="fu">round</span>(<span class="fl">0.75</span> <span class="sc">*</span> <span class="fu">nrow</span>(data)))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>train <span class="ot">&lt;-</span> data[index, ]</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>test <span class="ot">&lt;-</span> data[<span class="sc">-</span>index, ]</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>train_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train[,<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>train_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train[,(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>test_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test[,<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)])</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>test_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(test[,(p<span class="sc">+</span><span class="dv">1</span>)])</span></code></pre></div>
</div>
<div id="supported-frameworks-examples" class="section level1">
<h1>Supported frameworks examples</h1>
<p>With our common data generated, we are now ready to delve into the
different deep learning frameworks. In each case we will solve the same
regression problem with the previously generated polynomial data, with
two neural networks for each framework. These neural networks will have
the same structure but one will be constrained (<code>nn_con</code>) and
the other one unconstrained (<code>nn_uncon</code>) to showcase their
differences.</p>
<div id="kerastensorflow" class="section level2">
<h2><code>keras</code>/<code>tensorflow</code></h2>
<p>In this section we will show how to use <code>nn2poly</code> with a
<code>keras</code> neural network and how to impose the needed weight
constraints during training.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(nn2poly)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">library</span>(keras)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># This sets all needed seeds</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>tensorflow<span class="sc">::</span><span class="fu">set_random_seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<div id="model-definition" class="section level3">
<h3>Model definition</h3>
<p>First of all we will set the structure of our neural networks using a
sequential model in <code>keras</code>. This following function will be
used to create both the constrained and unconstrained neural networks in
the <code>keras</code> example.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>keras_model <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  tensorflow<span class="sc">::</span><span class="fu">set_random_seed</span>(<span class="dv">42</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">keras_model_sequential</span>()</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> <span class="dv">100</span>, <span class="at">activation =</span> <span class="st">&quot;tanh&quot;</span>, <span class="at">input_shape =</span> p)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> <span class="dv">100</span>, <span class="at">activation =</span> <span class="st">&quot;tanh&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> <span class="dv">100</span>, <span class="at">activation =</span> <span class="st">&quot;tanh&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> keras<span class="sc">::</span><span class="fu">layer_dense</span>(nn, <span class="at">units =</span> <span class="dv">1</span>, <span class="at">activation =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  nn</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we define both NNs. The only needed step to impose our
implemented weight constraints on a <code>keras</code> model is to use
the function <code>add_constraints()</code> and then train it as
usually. The constraints currently accept two possible types,
<code>&quot;l1_norm&quot;</code> and <code>&quot;l2_norm&quot;</code>. In both cases, the
norm for each weight vector (including the bias) incident on a neuron
will be constrained to be less or equal than 1. Using data scaled to the
<span class="math inline">\([-1,1]\)</span> interval, the l1-norm is the
one that guarantees best results.</p>
<p>Also, it is important to note that the weight constraints are imposed
on all layers except for the last one, which is expected to be linear
and not need a Taylor expansion.</p>
<blockquote>
<p><em>Note</em>: Our implementation differs slightly from the
constraints provided by <code>keras</code> because in our implementation
we join the bias with the rest of the weights while <code>keras</code>
default constraints allow only for bias or kernel constraints. Our
implementation uses a custom callback that is applied at the end of each
batch.</p>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>nn_uncon <span class="ot">&lt;-</span> <span class="fu">keras_model</span>()</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>nn_con <span class="ot">&lt;-</span> <span class="fu">keras_model</span>()</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>nn_con <span class="ot">&lt;-</span> <span class="fu">add_constraints</span>(nn_con, <span class="at">constraint_type =</span> <span class="st">&quot;l1_norm&quot;</span>)</span></code></pre></div>
</div>
<div id="training" class="section level3">
<h3>Training</h3>
<p>Now we can compile and train both NNs using standard the
<code>keras</code> approach. Note that we have to increase the number of
needed epochs with the constrained NN to learn properly.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">compile</span>(nn_uncon,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>        <span class="at">loss =</span> <span class="st">&quot;mse&quot;</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>        <span class="at">optimizer =</span> <span class="fu">optimizer_adam</span>(),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>        <span class="at">metrics =</span> <span class="st">&quot;mse&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>history1 <span class="ot">&lt;-</span> <span class="fu">fit</span>(nn_uncon,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>               train_x,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>               train_y,</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="dv">0</span>,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>               <span class="at">epochs =</span> <span class="dv">150</span>,</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>               <span class="at">batch_size =</span> <span class="dv">50</span>,</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>               <span class="at">validation_split =</span> <span class="fl">0.2</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="fu">plot</span>(history1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">compile</span>(nn_con,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>        <span class="at">loss =</span> <span class="st">&quot;mse&quot;</span>,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>        <span class="at">optimizer =</span> <span class="fu">optimizer_adam</span>(),</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>        <span class="at">metrics =</span> <span class="st">&quot;mse&quot;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>history2 <span class="ot">&lt;-</span> <span class="fu">fit</span>(nn_con,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>               train_x,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>               train_y,</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="dv">0</span>,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>               <span class="at">epochs =</span> <span class="dv">700</span>,</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>               <span class="at">batch_size =</span> <span class="dv">50</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>               <span class="at">validation_split =</span> <span class="fl">0.2</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="fu">plot</span>(history2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="nn-predictions" class="section level3">
<h3>NN predictions</h3>
<p>We can visualize the NN predictions vs the original Y values for both
neural networks and observe how both of them provide accurate
predictions (the values fall near the “perfect” diagonal red line).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Obtain the predicted values with the NN to compare them</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>prediction_nn_uncon <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn_uncon, test_x)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; 4/4 - 0s - 48ms/epoch - 12ms/step</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># Diagonal plot implemented in the package to quickly visualize and compare predictions</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_nn_uncon, <span class="at">y_axis =</span>  test_y, <span class="at">xlab =</span> <span class="st">&quot;Unconstrained NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Original Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABTVBMVEUAAAAAADoAAGYAOjozMzM6AAA6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmADpmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkLZmkNtmtrZmtttmtv9ubo5ubqtujo5ujshuq8iObm6Obo6Ojo6OjquOq8iOq+SOyOSOyP+QOjqQOmaQZjqQZmaQZpCQkGaQttuQtv+Q29uQ2/+rjm6rjo6rjqurq46r5P+2Zjq2Zma2ZpC2kDq2kGa2tma2tpC2tra2ttu227a22/+2/7a2///Ijm7Ijo7IjqvIq47IyMjI5P/I///bkDrbkGbbkJDbtmbbtpDbtrbbttvb25Db27bb29vb2//b/9vb///kq27kq47kq6vkyI7kyMjk5Mjk5OTk///r6+v/AAD/tmb/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//9v//+T///9/WZLHAAAACXBIWXMAAAsSAAALEgHS3X78AAAV2klEQVR4nO2d/X/b1BWHzZatLem6sQ0okG20QCjr25a2SxlhbKztStKMl620hDFipWUtxPr/f5xebFlWJPvo6Nx7z5G+91OcpO6T75EfJEuydM8oxhjkGIUuACPMgPiBDogf6ID4gQ6C+DFvcLkgpKliO5IQHzYS4jWQpoqFeDnSVLEQL0eaKhbi5UhTxUK8HGmqWIiXI00VC/FypKliIV6ONFUsxMuRpoqFeDnSVLEQL0eaKhbi5UhTxUK8HGmqWIiXI00VC/FypKliIV6ONFUsxMuRpoqFeDlSQbGjkafMZeL/sRfHk/sbuxDvjRyN6OZdiZ/c2EjEH1ya3DqM47W11dsEjO4jFe81r+bvJof3EvF3t+P0C9Z4T6SKTX1qPPkP4vtIrhJ/sD25CfE9JJeLf7L5/OKNzRji+0cuE78wglTnmTRVLMTLkaaKhXg50lSxEC9HmioW4uVIU8VCvBxpqliIlyNNFQvxcqSpYiFejjRVLMTLkaaKhXg50lSxEC9HmioW4uVIU8VCvBxpqliIlyNNFQvxcqSpYiFejjRVLMTLkaaKhXg50lSxEC9HmioW4uVIU8VCvBxpqliIlyNNFQvxcqSpYiFejjRVLMTLkaaKJZMn78OE+PCR7smaW+4hPnwkxGsgTRWLTb0caapY7NzJkaaKhXg50lSxEC9HmioW4uVIU8VCvBxpqliIlyNNFQvxcqSpYiFejjRVLMTLkaaKhXg50lSxEC9HmioW4uVIU8VCvBxpqliIlyNNFduRjCA+aGQoMsIaHzYyEBlhUx84MggZRXiPDx0Zgoywcxc+MgAZYa9eQaR/MsLhnIZI72Q0hngNkb7JaEZCfNhIv2QUFSTEh430SkYlEuLDRvokZ94hXkGkR7LwDvEKIv2Rc+8QryDSG1ny3k48hukR1f811vhQkX7IKFr4EZv68JFeyKjyM8SHj/RBVr1DvIJID+QJ7xCvINI9edI7xCuIdE7WeId4BZGOyajOO8QriHRL1mqHeA2RTskG7xCvINIl2eQd4hVEOiQbvUO8gkh3ZLN3iFcQ6Yqs350vkRAfNtIRuUw7xGuIdEMu9w7xCiKdkCu8Q7yCSBfkKu8QryDSAbnSO8QriJQnV3uHeAWR0uTSw7gyCfFhI4VJinaI1xApS9K8Q7yCSFGS6B3iFURKklTvEK8gUpAke4d4BZFiJGl3vkRCfNhIKbKFdojXEClEtvIO8QoiZch23iFeQaQI2dI7xCuIlCDbeod4BZECZGvvEK8gsjPZ5jCuTEJ82MiuJEM7xGuI7EiyvEO8gshuJM87xCuI7EQyvUO8gsguJNc7xCuI5JOc3flSJsSHjWSTUcdMiA8bySWjrpkQHzaSSc76TPAzIT5sJI8s+kzwMyE+bCSLnPeZ4GdCfNhIDhlJZEJ82Mj2ZHEYB/FipIViF/tM8DMhPmxkW7LSZ4KfCfFhI1uS1T4T/EyIDxvZjlw4SwvxYqT2Yk/2meBnQnzYyBZk9VMZiBcjVRdb22eCnwnxYSPJZH2fCX4mxIeNpJINfSb4mRAfNpJINvWZ4GdCfNhIGtnYZ4KfCfFhI0lk/UVWEC9G6iy26eI6iBcjVRa7tM8EP7NZ/OT+xm7yePOtdw4hPhy5vM8EP7NZ/MGlya3D+Nlm9sPa2uptAoaD0dAFWmrUib+7Hd/bi59sXHg3+7HD/1xmSH3Fruozwc9sFp9YT/48P0wfIT4MufSeCWeb+u3Jzb3469101Yf4EOSKe2VciX9+8cbmk81nGzfexKY+CEnpM8HPbBZfGR0yzJCqiiX1meBnQnzYyEaS1meCnwnxYSObSGKfCX4mxIeNbCCpfSb4mRAfNrKeJN36DvFipJJiiVMeQLwYqaPYNn0m+JkQHzbyJNmqzwQ/E+LDRp4g2/WZ4GdCfNjIKtmyzwQ/E+LDRlbINjNZQbwYGbrYdjOYQbwYGbhYRp8JfibEh40skZw+E/xMiA8bOSdZfSb4mRAfNrIgeX0m+JkQHzZyRjL7TPAzIT5s5JTkTEgM8WJkiGJHI+5E1BAvRjqMTP3W//1o1KHPBJ+EeC+Rqd+mJ7r0meCTEO8lslH8mO0d4uXIAJt6dl8ZiBckA0RGoV4giA8SOd0ARF0bjPBJiA8ROX3L795ngk9CfIjIXLxAnwk+CfFBIgvvEK+B9Bop0meCT0J8oEiZPhN8EuLDRBaH7xCvgPQWWfpUBuIVkL4i5fpM8EmI9x8p2GeCT0K890jJPhN8EuJ9R4r2meCTEO85svppHMQrIN1HnrzICuIVkI4i55/Fi/eZ4JMQ7zxyfvWNfJ8JPgnxziML8Q76TPBJiHcfucw7xGsgnUY66TPBJyHeU2TTRZUQr4B0F9l8rwzEKyCdRS65hhriFZCuIqOmi+odZq4iId515GgUNd5G4yqTQEK848jcO8SrJp2IX+4d4jWQDiKjaJl1N5kkEuKdRrruM8EnId5lpPM+E3wS4h1Guu8zwSch3l2khz4TfBLinUX66DPBJyHeVSRxqguIV0AKRpJnMFMvHqPNcNz9W2xgjZeN9NZngk9CvINIf30m+CTEy0euOkvrIrM1CfGykYnzFZ/KyGeySIgXjRyNkt15iO9cnWdSQHy2mcemfnDiW729C2XyyEXxt1+H+C5k1Gpll8lkkpU1/tP1xxDPJlu+vYtkcsnqpv7BC6dO34F4Fhktm57cUSabXBT/3eXz2NQzyfzsvNFN/c7HeI9vPVLXMXveeR3il4wg1XkmWWC2dY8D9ZngkxDfERxl4kP1meCTi+KPHybjS4hvMXLvphazRvy/P0rGX2uP6IJU55lkburH4fpM8MnKpv74vVOnfoTDuXYjMraYdeKf/mF/658QTxv5afkoZIMRPlkVf/7ojf0tiKeMbLdulN8CbWoxa/fqP3/0fv05nCDVeSZbgTPv/RB/fPkUTtnSRr47Pz1TZ2ox69/ja1d3iD8xRgvtgE0tZp34H67iOJ40ytv5LpFaxB/jOJ42Uu2lKU5MLWbtzh3O3BHHKCp/FGdqMWvEP3yENZ44dPSZ4JOVNf7pT3780xdO1x3IB6nOM9kCVNJngk9WxScH8X/++ysQv2Jo6TPBJ6viX42Pf/83iF8x1PSZ4JMV8fFnv1j/+LO6N/kg1XkmqeDJT99NLSb26nlg3a3vphYTe/UsUFWfCT5ZWeO/u167ukN8MXT1meCTFfE/vIxN/dKhrM8En6yIxynb5UNbnwk+WRG/f+rU2fqbqIJU55lcDi67mNbUYtaI3389OZQ/gzW+bkwvshKO1CH++GrqfB8XYpwcCx/CCkYqEX8ldf4+xJdGbnuFd1uLWbOpP1p/+HDnHN7j52N6++uK/iK2FrP2OP7Kyw1H8kGq80w2i181o5Gpxaw9Zds4glTnmWze1EcrboA2tZgQTwZX3hNpajEhnggSJiQ2tZgQTwFL11C7iIR4DWTtzt2yNpHdIyFeA1knnjZznanFhPjlYGacOGOhqcWE+CYwv/+5zRQnphYT4hvA0WyQ+4vYWkyIbwAL7x4iIV4DubipJ+3Od42EeA1kGSTuzneNhHgNZBlsNwG5qcWE+CVgyxkLTS0mxNeA0/W87UyVphYT4k+CbQ/jOkdCvAYyrs5w4j4S4jWQ8cy7mVnn+STEl8ZsBrNhi5/c39idPQ5IPKevjLHFXCH+4NLk1uH0cSDi41anaUUiFYq/ux3f25s+xmtrq98MDI/R9AWIrLT/lhp14hPfxZ+432t8cQ21v8jgZLP4g+3Jzb3p4wDEJ+YN9pngk83in1+8sflkM32Mey6++BTWQrFSZLP4yghSnWsyW9Nn3pM3eg+RWshBiy8utRnl90ipLlaYhPh8lc/uiVRdrDA5aPHT3fnpRNQQPxzx82uoR3mjUB+ROsiBip+dlJ1eQ222wQifHKb44nT84sW0Oot1Qw5R/GxHPv++dLpOY7GuyAGKL3tfPE2rsFhn5EDF51+rt74rLNYZOUDx4+zQvfL27jhSHzlE8aWz8/4itZFDFN94b5zGYl2RwxM/avSusFh35ODEz72fvLBOXbEOyaGKH9fdC6uuWIfk4MRPz9L2pMEInxyi+B71meCTgxO/bKoLdcU6JIcovkd9JvjksMRnl130qc8EnxyQ+NnuvMdIxeRwxBNufddTrHtyAOJL11ysuDVOQbHeyP6Ln38Ku/KWyPDF+iOHIX5E8q6gWH9k/8UX11CvvgVaQbHeyGGIz770sc8En+y/+Bb3QIcv1h85FPGkGczCF+uP7L/4ZZ/KuIo0QPZX/HQTv+IsrWikJbK34kt3wpJnLLSnj0/2XPzMO8RXyX6LL2au8xJpiuyr+Nmlda0mJLanj0/2XXzP+0zwyf6Jn05lk98n1W5CYnv6+GTvxJdviRy3nJjWnj4+2U/xpYttsKmvJ3snvnQcN4A+E3yyx+Lbz0xrTx+f7Jf4oiksp6+MRX18slfi59fatGoT2SXSLNlD8SnJ8m5QH5/slfjpLnzMnXjenj4+2S/x48x9zG04YE8fn+ybeN7ufKdIm2RvxBe3TUT8RhP29PHJvogvrreJOkxCbU8fn+yb+KjL7OP29PHJvoifbuqjTrOP29PHJ/sivnwLNMQTyF6Jjzpm2tPHJ/shPvskNpqdroN4AtkL8ZWLrCCeQPZGvES/AXv6+KRd8aVLaypn6yCeQJLFaxvpWj7/YWhdoKWGwTW+clGlSKa99ZZPmhU/ns9sU/0UFuIJpF3x+ai7yAriCaR18XW3QEM8gbQpft41ru5iG4gnkCbFl6auq7voAuIJpHHxtRdVQjyBtCo+/6b+YlqIJ5AWxRcTmEk3mrCnj08aFD+do7T5GmqIJ5BGxY+XzWAG8QTSnPh8woOlM9dBPIG0Jp4yQSnEE0ij4pdOeQDxBNKY+IWpLprMQzyBtCW+fOs7xHciDYmvTlCKTX0X0ob42XwHY9LEtBBPIE2In89kRZryAOIJpDHxpFugIZ5AmhA/buUd4imkDfGzW6QcN5qwp49PGhHfauI6iCeQ6sXPpzAjz3AC8QRSu/jpqbpxm5ltIJ5AqhZfzE46pvaR6pZpTx+f1Cye6R3iKaRi8aOS+FYzmEE8gVQufpxfO99u5jqIJ5CKxRefwrSdsBDiCaRe8cVnMf76DdjTxye1ip/t1DG8QzyFVCq+2JvnTEQN8QRSs/iGeyJdZVrUxyeVil+4yMpXpkF9fFKl+OLsfJveYR0zO4EGSY3ii7PzPO8QTyH1imf3mYB4CqlPPOEeKfHMrqBBUp344jAuwCtiTx+f1Co+CvGK2NPHJ9WJz7bz6WEcxDsl9YkfT9/eId4pqVF8xz4TEE8hFYrv2mcC4imkPvGzwziId0rqEF86RVccvkO8U1KF+Pmt7qVPZSDeKalLvEifCYinkCrEj+sutoF4p6QO8fkQ6jMB8RRSkXipPhMQTyH1iBfrMwHxFFKN+BOfwkK8U1KJ+JqL6yDeKalBvHCfCYinkArES/eZgHgKqUF8/UWVEO+UVCC+4WJaiHdKhhffdFElxDslm8VP7m/sJo8333rn0IH4mk9liCQ/0x1okGwWf3BpcuswfrbpZI0n3BIJ8U7JZvF3t+N7e/GTjQvvJj+sra1+M2gzpk3A0f078Dgh/ptPdhPryZ/nh+lj7GZTv/SeCazxTskG8d9/e3iwPbm5F3+9m6768uLTsfxeGYh3SjaIT8bzizc2n2w+27jxZiwtnjTlAcQ7JZvFV4ZgdbQZzCDeKRlK/OopDyDeKelZfNEFujXJz/QAGiT9im8zoxHEOyX9i6fOaATxTknvm3ryxPMQ75T0LL7x03cCyc90DhokvYuPiN4h3i3pW7yHPhMQTyE9i/fRZwLiKaRf8V76TEA8hfQq3k+fCYinkC7FZ9MUln721GcC4imkQ/HZuZp4/lPLGQsh3inpS/yIfBhXro43IJ5A+trUR6O2MxJDvFPSpfhSddG49UzUEO+U9CPea58JiKeQXsT77TMB8RTSh3jeBOQQ75R0L57XVwbiHZPOxfvvMwHxFFJe/OLue4A+ExBPIcXFjxYO2EP0mYB4CulWfJA+ExBPIZ1u6sP0mYB4Cikvfj6iztV5Jk0Vq1Z8FKrBCMRTSGfiw/WZgHgK6Up8wD4TEE8hHYkP2WcC4imkG/FB+0xAPIV0Ir50us7UK2KqWEXiZ30mAjcYgXgKKSi+6AorV51n0lSx2sSH7zMB8RRSelOvoM8ExFNISfFjHX0mIJ5Cyoo/ee28qVfEVLGaxNdcPG/qFTFVrB7xUTSCeDOknPj07f3kXROmXhFTxWoR33BxnalXxFSxSsQr6jMB8RSyk/j5ll1TnwmIp5BdxJfavjuqzjNpqlgF4pfdK2PqFTFVbPhNvbY+ExBPITuJz4a6PhMQTyE7i9fXZwLiKWRX8Qr7TEA8hewoXmOfCYinkJ3EE259N/WKmCo2oHilfSYgnkJ2EK+1zwTEU0i+eLV9JiCeQrLFE6e6MPWKmCo2kHjqFCemXhFTxfoSvzjQBrofo+Ua32IGM1OrgqliA2zqlfeZgHgKyRCvvc8ExFPI9uLV95mAeArZWrz+PhMQTyHbim87U6WpV8RUsV7Ft5+Q2NQrYqpYn+IZE9OaekVMFevxBI7fszZrXtNCRQbObH3mzsOAeA+ZEB8qEuIxQgyIH+iA+IEOiB/o0CZ+cn9jN/361SW/ibNcn5k+l7JYzru/3c5+1Cb+4NLk1mEcP7vg7SXJE6e5XjN9LuUs86vZcmoTf3c7vrcXT279x9tLkifmj34zfS7lLPPZ2/c3sx9Vif/mk92ktuTPwfYTby9Jnpj/8ZvpcymLzM3/vq1vjf/+28OD7cnNvcn9ty78xteGN0ucPvoa/pdytpz5xi1WJj4Zzy/e2HySbIz8rQt5YvroKzHEUs4yn1380++yH7WJx/A0IH6gA+IHOiB+oAPiBzr6K/7ojTh+f6vumeMvp9/sl54+vvo4PjqXIvljlbm6s5Wz+7W/09zot/jbiaSHuenMdvL9/77MnnkcHz/M/tns6Uep+Be2EiR/nD6X/sPZ0+l3KVv8Lsuj7+IfrH+4/un6h68cJV8/SP7bee32+QfnPnjx+tHZv6zvzJ9+ZedMIv61Xz5OxGePcfxg/S/r6T+cPr2zlX734Fz2Nftdj0MvYpfRd/H7W8dXr9xJtt134tu/Tr7fWb/++OiNZHN9/HnqMn368qsfvXf6Trapf+PoXCI+e8zeCBIkvj19emcr+R1xys5+F8SrHNlb9Z1c/PEXM1kPH316NhN/+/qjq7n4K398+PmVqfj49qmt/DET//615L/p06n44y8gXv04fu/FX52LU7P/euny+acvXT67n63xl88fnbmyFe+/euX0ta386Wtnn7507Uwm/oefb+WPyab+9JWfJfKfTp/e2Up+R8bOfhfE93P0ZPe9YUB84/js49AVuBwQP9AB8QMdED/QAfEDHRA/0PF/VmFnCoPOEbQAAAAASUVORK5CYII=" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Obtain the predicted values with the NN to compare them</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>prediction_nn_con <span class="ot">&lt;-</span> <span class="fu">predict</span>(nn_con, test_x)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; 4/4 - 0s - 91ms/epoch - 23ms/step</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># Diagonal plot implemented in the package to quickly visualize and compare predictions</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_nn_con, <span class="at">y_axis =</span>  test_y, <span class="at">xlab =</span> <span class="st">&quot;Constrained NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Original Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="using-nn2poly" class="section level3">
<h3>Using nn2poly</h3>
<p>After the NNs have been trained, we can directly call
<code>nn2poly</code> on the <code>keras</code> model.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Polynomial for nn_uncon</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>final_poly_uncon <span class="ot">&lt;-</span> <span class="fu">nn2poly</span>(<span class="at">object =</span> nn_uncon,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                      <span class="at">max_order =</span> <span class="dv">3</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># Polynomial for nn_con</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>final_poly_con <span class="ot">&lt;-</span> <span class="fu">nn2poly</span>(<span class="at">object =</span> nn_con,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>                      <span class="at">max_order =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>We can visualize the polynomial predictions versus NN predictions</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># Obtain the predicted values for the test data with our two polynomials</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>prediction_poly_uncon <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> final_poly_uncon, <span class="at">newdata =</span> test_x)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>prediction_poly_con <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> final_poly_con, <span class="at">newdata =</span> test_x)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_nn_uncon, <span class="at">y_axis =</span>  prediction_poly_uncon, <span class="at">xlab =</span> <span class="st">&quot;NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Polynomial prediction&quot;</span>) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Polynomial for nn_uncon&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_nn_con, <span class="at">y_axis =</span>  prediction_poly_con, <span class="at">xlab =</span> <span class="st">&quot;NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Polynomial prediction&quot;</span>) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Polynomial for nn_con&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<p>We can clearly see how the constrained NN allows to obtain a close
approximation with <code>nn2poly</code> while the polynomial obtained
for the unconstrained one is not a good representation.</p>
<p>We can also represent the obtained polynomial coefficients and
observe how the constrained case clearly has terms <code>2,3</code> and
<code>1</code> with the same sign as the original polynomial while the
rest are close to 0.</p>
<blockquote>
<p><em>Note</em>: The coefficients values are not in the same scale as
the original polynomial due to the fact that we have scaled all the data
before training, even the response variable Y. Furthermore, as data has
been scaled to the <span class="math inline">\([-1,1]\)</span> interval,
interactions of order 2 or higher would usually need a higher absolute
value than the lower order coefficients to be more relevant</p>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot</span>(final_poly_uncon, <span class="at">n =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(final_poly_con, <span class="at">n =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
</div>
</div>
<div id="luztorch" class="section level2">
<h2><code>luz</code>/<code>torch</code></h2>
<p>In this section we will show how to use <code>nn2poly</code> with a
<code>torch</code> neural network, built with its higher level API
<code>luz</code>, and how to impose the needed weight constraints during
training. Furthermore, we will explain how to use
<code>luz_model_sequential()</code>, a helper needed to create a
<code>torch</code> model in an adequate manner so that it can be easily
recognized by <code>nn2poly</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">library</span>(torch)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">library</span>(luz)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
<div id="data-loader-for-torch" class="section level3">
<h3>Data loader for <code>torch</code></h3>
<p>In this framework, we need to manipulate a bit our data to use it as
input for a <code>torch</code> model. This can be done dividing our
<code>train_x</code> data intro only train and validation matrices and
using <code>luz::as_dataloader()</code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Divide in only train and validation</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>all_indices   <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(train_x)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>only_train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(all_indices, <span class="at">size =</span> <span class="fu">round</span>(<span class="fu">nrow</span>(train_x)) <span class="sc">*</span> <span class="fl">0.8</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>val_indices   <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(all_indices, only_train_indices)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># Create lists with x and y values to feed luz::as_dataloader()</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>only_train_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_x[only_train_indices,])</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>only_train_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_y[only_train_indices,])</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>val_x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_x[val_indices,])</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>val_y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(train_y[val_indices,])</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>only_train_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> only_train_x, <span class="at">y =</span> only_train_y)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>val_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> val_x, <span class="at">y =</span> val_y)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>torch_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  <span class="at">train =</span> luz<span class="sc">::</span><span class="fu">as_dataloader</span>(only_train_list, <span class="at">batch_size =</span> <span class="dv">50</span>, <span class="at">shuffle =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="at">valid =</span> luz<span class="sc">::</span><span class="fu">as_dataloader</span>(val_list, <span class="at">batch_size =</span> <span class="dv">50</span>)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="model-definition-1" class="section level3">
<h3>Model definition</h3>
<p>Now we will set the structure of our neural networks using a
sequential model in <code>torch</code>. To do so we have implemented the
helper <code>luz_model_sequential()</code>, which lets the user stack
linear layers in a similar way as <code>keras</code> and allows
<code>nn2poly()</code> to be directly used in the model without the need
to extract weights and activation functions manually as in the default
example of <code>vignette(&quot;nn2poly-01-introduction&quot;)</code>.</p>
<p>This following function will be used to create both the constrained
and unconstrained neural networks in the <code>torch</code> example.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>luz_nn <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  torch<span class="sc">::</span><span class="fu">torch_manual_seed</span>(<span class="dv">42</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">luz_model_sequential</span>(</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_linear</span>(p,<span class="dv">100</span>),</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_tanh</span>(),</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_linear</span>(<span class="dv">100</span>,<span class="dv">100</span>),</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_tanh</span>(),</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_linear</span>(<span class="dv">100</span>,<span class="dv">100</span>),</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_tanh</span>(),</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>    torch<span class="sc">::</span><span class="fu">nn_linear</span>(<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  )</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we define both NNs. In this case, differing from the
<code>keras</code> example, we will impose the constraints later to
follow the same approach as in <code>luz</code> documentation. However,
the use of <code>add_constraints()</code> is analogous.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>nn_uncon <span class="ot">&lt;-</span> <span class="fu">luz_nn</span>()</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>nn_con <span class="ot">&lt;-</span> <span class="fu">luz_nn</span>()</span></code></pre></div>
</div>
<div id="training-1" class="section level3">
<h3>Training</h3>
<p>First we train the unconstrained NN using ans standard
<code>luz</code> approach.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>fitted_uncon <span class="ot">&lt;-</span> nn_uncon <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>    luz<span class="sc">::</span><span class="fu">setup</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>      <span class="at">loss =</span> torch<span class="sc">::</span><span class="fu">nn_mse_loss</span>(),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>      <span class="at">optimizer =</span> torch<span class="sc">::</span>optim_adam,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>      <span class="at">metrics =</span> <span class="fu">list</span>(</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>        luz<span class="sc">::</span><span class="fu">luz_metric_mse</span>()</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>      )</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>    luz<span class="sc">::</span><span class="fu">fit</span>(torch_data<span class="sc">$</span>train, <span class="at">epochs =</span> <span class="dv">50</span>, <span class="at">valid_data =</span> torch_data<span class="sc">$</span>valid)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>fitted_uncon <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<p>Then, we train the constrained NN by using the function function
<code>add_constraints()</code> before calling <code>fit()</code>. The
constraints currently accept two possible types, <code>&quot;l1_norm&quot;</code>
and <code>&quot;l2_norm&quot;</code>. In both cases, the norm for each weight
vector (including the bias) incident on a neuron will be constrained to
be less or equal than 1. Using data scaled to the <span class="math inline">\([-1,1]\)</span> interval, the l1-norm is the one
that guarantees best results.</p>
<p>Also, it is important to note that the weight constraints are imposed
on all layers except for the last one, which is expected to be linear
and not need a Taylor expansion.</p>
<p>Note that we have to increase the number of needed epochs with the
constrained NN to learn properly.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>fitted_con <span class="ot">&lt;-</span> nn_con <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  luz<span class="sc">::</span><span class="fu">setup</span>(</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    <span class="at">loss =</span> torch<span class="sc">::</span><span class="fu">nn_mse_loss</span>(),</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    <span class="at">optimizer =</span> torch<span class="sc">::</span>optim_adam,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="fu">add_constraints</span>(<span class="st">&quot;l1_norm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">fit</span>(torch_data<span class="sc">$</span>train, <span class="at">epochs =</span> <span class="dv">700</span>, <span class="at">valid_data =</span> torch_data<span class="sc">$</span>valid)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>fitted_con <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<blockquote>
<p><em>Note</em>: Our implementation uses a custom callback that is
applied at the end of each batch.</p>
</blockquote>
</div>
<div id="nn-predictions-1" class="section level3">
<h3>NN predictions</h3>
<p>We can visualize the NN predictions vs the original Y values for both
neural networks and observe how both of them provide accurate
predictions (the values fall near the “perfect” diagonal red line).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Obtain the predicted values with the NN to compare them</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>prediction_NN_uncon <span class="ot">&lt;-</span> <span class="fu">as.array</span>(<span class="fu">predict</span>(fitted_uncon, test_x))</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co"># Diagonal plot implemented in the package to quickly visualize and compare predictions</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_NN_uncon, <span class="at">y_axis =</span>  test_y, <span class="at">xlab =</span> <span class="st">&quot;Unconstrained NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Original Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Obtain the predicted values with the NN to compare them</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>prediction_NN_con <span class="ot">&lt;-</span> <span class="fu">as.array</span>(<span class="fu">predict</span>(fitted_con, test_x))</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co"># Diagonal plot implemented in the package to quickly visualize and compare predictions</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_NN_con, <span class="at">y_axis =</span>  test_y, <span class="at">xlab =</span> <span class="st">&quot;Constrained NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Original Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABNVBMVEUAAAAAADoAAGYAOjozMzM6AAA6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmADpmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkLZmkNtmtrZmtttmtv9ubo5uq8iObm6Obo6Ojo6Oq8iOq+SOyOSOyP+QOjqQOmaQZjqQZmaQZpCQkGaQttuQtv+Q29uQ2/+rjm6rjo6rjqur5P+2Zjq2Zma2ZpC2kDq2kGa2tma2tpC2tra2ttu227a22/+2/7a2///Ijm7Ijo7IjqvIq47IyMjI5P/I///bkDrbkGbbkJDbtmbbtpDbtrbbttvb25Db27bb29vb2//b/9vb///kq47kq6vkyMjk5OTk///r6+v/AAD/tmb/yI7/25D/27b/29v/5Kv/5Mj/5OT//7b//9v//+T///9xLFaSAAAACXBIWXMAAAsSAAALEgHS3X78AAAUs0lEQVR4nO2dDX/cxBGHj9atE5ym0BYIxBAwoXGS1nbsFENbStJgxyW0NYkBe+3QGHz6/h+hejmd70U6aXdnd2d2//NzFOccPTvax9qTTtLOIEMkGYPQCSDCBMQnGhCfaEB8otFD/Mkoxt+YBwGCSRo8EEYMiJePgPhEERCfKALiE0VAfKIIiE8UAfGJIiA+UQTEJ4qA+EQREJ8oAuITRUB8ogiITxQB8YkiID5RBMQnioD4RBEQnyiigzEYNK6zQPw/97Ns+GR1D+J5IxYzBoNG8+3ih5urufij28MHx1m2tNQ9JiBYRiG+/YcNrw2PH+9n2aPtrPgLezxjBPlQXxjP/0A8cwT5wV1h/Gh7uAXxvBEOxJ+tnd/aXMsgnjUCp3OJIiA+UQTEJ4qA+EQREJ8oAuITRUB8ogiITxQB8YkiID5RBMQnioD4RBFGDAXx4hEGDKWwx8tH6DMUhvoYENoMdQLxMSB0GapcB+LFIzQZqloH4sUj9BhqtA7Ei0doMVS9DsSLR+gwau8QHwFCgzH2DvERIPozLr1DfASI3owJ7xAfAaIvY9I7xEeA6MmY8g7xESCaGPNPSk57h/gIEA2MuYfi1Yx3iI8A0UP8rHaIjwHRPdTPe4f4CBCdjAbvEB8BoovR5B3iI0B0MBq9Q3wEiMWMZu8QHwFiIaPFO8RHgFjEaPMO8REgFjBavUN8BIh2Rrt3iI8A0cpY4B3iI0C0MRZ5h/gIEM2MucsyM+tAvHhEI2OxdoiPAdHE6PIO8REgGhid3iE+AsQ8o9s7xEeAmGP08A7xESBmGX28Q3wEiBlGL+8QHwFimtHPO8RHgJhi9PQO8REgJhl9vUN8BIgJRm/vEB8B4pLR3zvER4CoGR2XZWbWgXjxiBFDRzvEx4CoGHreIT4CRMnQ9A7xESAKhq53iI8AkTO0vfcXj2AcynRF7PGSEQb7O4b6GBDKhAHx4hHKiAHx0hHKjAHxwhHKkAHxshHKlAHxohHKmAHxghH15TiITwtxOfe8SbsQLxUxMfe8SbsQLxQxOfe8SbsQLxMxNfe8SbsQLxIxPfe8SbsQLxExM/e8SbsQLxAxO/e8SbsQLw8xN/e8SbsQLw4xd/kd4pNANBQdMGkX4oUhmooOmLQL8bIQjUUHTNqFeEmI5qekID52RNvc8ybtQrwcROvc8ybtQrwYRPvc8ybtQrwUxIK5503ahXghiEVzz5u0C/EyEAvnnjdpF+JFIBbPPW/SLsRLQHTMPW/SLsQLQHQ8FQnxkSI6iw6YtAvx7BHdRQdM2oV47ogeRQdM2oV43og+k9dBfHyIfnPPm7QL8ZwRPeeeN2kX4hkj+s49b9IuxPNF9J573qRdiGeL6D/3vEm7EM8VoTH3vEm7EM8UoTP3vEm7EM8ToTX3vEm7EM8SoTVZJcRHg9AsOmDSLsQzROgWHTBpF+L5IbSLDpi0C/HsEPpFB0zahXhmCK1aUuZpQDwzhNHc8ybrQDwrhIl3iJePMPIO8eIRZt4hXjrC0DvEC0eYeod42Qhj7xAvGmHuHeIlIyy8Q7xghI13iJeLsPIO8WIRdt6JxQ+frO7ly60PPzqGeKcIg8sy9mm0iz+6PXxwnL1aK/+xtNQ9JiDMwrgUNEE0iX+0nT3ez85WP/i4/KfNbxfBL6gDBhOE7e5umEa7+Nx6/nV+XCwh3hmCwDv1UL893NrPvtsrdn2Id4UwKgFOkUa7+PNbm2tna69WN9/HUO8MYVYCnCKNdvEzYdMIQZ4OGAwQhiXAKdKA+IAI0xLgFGlAfDiEcQlwijQgPhjCvAQ4RRoQHwphUQKcIg2ID4Soz98h3jsjKMKq9jtFGhAfAjFxWQbivTPCIWxLgFOkAfH+EdYlwCnSgHjvCPsS4BRpQLxvBEEJcIo0IN4zgqIEOEEaEO8ZQVICnIIB8V4RNCXAKRgQ7xNBVAKcggHxHhFUJcApGBDvD0FWApyCAfG+EIPm2yoh3jvDKWIwmH1Bzb1ElQXE80EMBrOa1dwrZFlAPB/ErHil5scAsiwgnhFixrvTLCCeK4K6BDgFA+IdI/Jdn7wEOAUD4t0i8vd6+hLgFAyId4vIvTcf1BFmAfEcER3eId4/wwvCSQlwCgbEO0W4KQFOwYB4lwhHJcApGBDvENFntguI985wjnBW+52CAfHOEO5qv1MwIN4Rou/kdRDvneEU4bQEOAUD4p0g3JYAp2BAvAuE4xLgFAyId4Do+piWOAuIZ4Jou8vKVRYQzwOh5m+4c5sFxLNAqIZbbN1mAfEcED5KgFMwIJ4W4aUEOAUD4kkRfkqAUzAgnhJhMPk8xHtn0CM0j+uosoD4sAilBg2PTnnIAuKDIsrTd4inztMBgxahqr0dQz1xng4YpIjisE5bOlEWEB8O4bcEOAUD4ikQnkuAUzAgngDhuwQ4BQPi7RHeS4BTMCDeGuG/BDgFA+JtEQFKgFMwIN4SEaIEOAWjt3hEY4SsAU4Q2OMNEfa1oNnv8YSJxiM+UO13CgbEm4dSmdnHtKRZGDIg3jiqyzK25iHeO8MSUXuHeKd5OmDYIdQJyQ4P8f4ZVojysM7aum0WFoxp8TvvQXyvGHkX3Bkze/zXKy8gvjtG3uPZ47Ps6WvLV76E+MVRnb7HJP7HOzcw1HdG/bFNREP97hd4j++MiRojgjtjdqiH+K5QEydxgjsD4jVj6vM6wZ0xLf7iMI9vIb49qtuooxP/37/m8bfGMzrCROWKryevi2+ov/hkefkXOJ1rCReloJmIf/mng41/QXxzzE9qJLgzZsXfOL15sAHxTaHmr8kI7owZ8dk3zx82f4ZDmKhM8arhYpzgzph9j7+zjI9sG0OdNFyEFdwZc+/xjbs7xKuTuMX/fBfn8U0xvu0i2qEe5/FNMf7YJlrxGT65a4j6MuzcLTeCO2Na/OFz7PHz0X73vODOmNnjX/7ql79+7UrTiTxhosLEu60BzkV8fhL/l3+8DfGX4bgGOBfx72QXf/w7xI9jcU0hwZ0xIz579sbKF8+a3uQJExUkvuPhOMGdMSseR/WT0fVQpODOmBaPo/qp8FEKmof47Mf7jbt7muK9lIJmIv7ntzDU1+GnFDQT8fjIdhyeSkEzEX+wvHyt+SEqwkRFiO81Oa3gzpgWf/Befip/FXv85WWZsFk4ZEyJv7hbOD9I/UaMXHfPpyIFd8a0+PXC+cPExee6+04+L7gzpof605XDw93rib/H5977TnIiuDOmxWc/rr/VciZPmChz8Sej2jJJiW8PwkR5i1casx4I7gyInwmtOQsFdwbET4feXJWCOwPip0KzppDgzoD4yej3sY3rLLwwIH4itCezEtwZEH8ZqhrlMdQnI77yrfQnMBPcGRA/GtwHTU/D+szCMwPiR+KVSWVYwZ0B8SfV5TijeSoFdwbEl2Hw/u4gC58MiC/CtBa04M6A+BOLmkKCOwPiT5Qy2dmps/DNgHjDt3fiLLwzkhffOKmR9yz8M1IXb1dTSHBnJC5+fFkG4scxfLK6Vy9jFT+ekxjiL+Po9vDB8WgZqfjxaRze4yfi0Xb2eH+0zJaWut8MxEV+Ghc6hdDR1AG57/FXFuMe3zApcYAs+O3xR9vDrf3RMkbxKrMvESq4M9rFn9/aXDtbK5ZZdOLLp+MymzN4iiyoEDid6xuDy6ekMNSnJZ7Gu+TOSFK8IvIuuTNSFN/7YVinWdAhIL5f1N55bAnEO2eMdvHx6TuPLYF414yR7svL7zy2BOJdMyrfajDe9XlsCcQ7Z1TeudUAh3gfjKm753lsCcR7YEw/JcVjSyDePaMu/c6qFDTEO2fM1o7jsSUQ75ZRT1qIob5eJw3xE5dlcHBXrZOGeDXvncmWQLxLRjXJCcv6oBDvkNH8cByPLYF4d4yWSQ94bAnEO2O0PRXJY0sg3hWj9WlYHlsC8Y4Yo8vvDep5bAnEu2FcnsbNmeexJRDvhFE//Q7xc+vELH5iskoM9bPrRCy+Y7JKHlsC8fSMjtuoeWwJxJMzqtus2m+f57ElEE/NUO37OlkaPBAQPxGqe3JaHlsC8aSMPnOU8tgSiKdjVHfbQPzideIT3/chaB5bAvFkjIa7rFylwQMB8UWM93cM9YvXiUx87d1PGjwQEH8yHuc9pcEDAfEnWrNd8NgSiCdh6Exuw2NLIJ6CoTWpEY8tgXh7xkBvViMeWwLx1gxN70y2BOJtGUp3UmIeWwLxlgz90rA8tgTi7RgGJUJ5bAnEWzGUQZUJHlsC8eaM4jJsmDR4IFIVX3w8HygNHohkxZuVAGeyJRBvzNA/nidLgwciUfH1pEYh0uCBSFF8dVyHod5gHdHiy+M6I+s0afBApCjeptgEjy2BeG1GUUNs9AQ0xOuvI1Z8PsxXs1lhqE9MvG2JUB5bAvGajI6H3/2kwQPhVjyzGJSloFEO2jLk7fGGH9MSp8EDkdJQPyoFHToNHoiExNeloAOnwQSRjnhVn8eHTYMLIhnxxfs7gzTYIFIRb3v+TpQGH0Qi4q3P32nSYIRIQ/yollToNDghkhA/8h46DVaIFMSPb7vg0eU8EPGLV+Vt1BBPwZAkvn5qoljw6HIeiNjFq8mb63h0OQ9EzOKLu21OIJ6QIUP8oH5aJr7CsBC/KAZzT8vw6HIeiIjFz39cx6PLeSAiFj9/FzWPLueBiFZ8093zPLqcByJW8Y23VfLoch6IKMVXT01EXDQO4htjUB3PWzEI0uCNiFN87DXAIX42SuGtk9fx6HIeiLjEl8JV67PvPLqcByI+8QvusuLR5TwQcYmfqClkziBIQwAiLvH1ZBctt1Xy6HIeiMjEq4WVYXl0OQ9EXOLV4juoeXQ5D0Q04gvlXZOU8uhyHohYxI+O560YBGnIQUQkPqFS0BA/jqomMMS7ZfATPz6Ps2AQpCEIEYH48gyunrzOkEGQhjCEfPHlYZ0aPzRhxCBIQxoiCvF9a03w6HIeiBjE964xwqPLeSDEi9epMcKjy3kg5Ivv/Nimm0GQhjiEePEa3pl0OQ+EdPFaNcR4dDkPhHDxerXjeHQ5D4Rs8Zo1A3l0OQ+EaPG6tSJ5dDkPhGDx+jVCeXQ5D4Rc8TrncQ7TkIqQK775KSk9BkEaUhFixSuDiah5dDkPhFDxKu0a4MmKN9LOpct5IESKN/TOpMt5ICSKN/XOpMt5IASKN/bOpMt5IOSJNzmcd5CGdIQ48T3uou5kEKQhHiFNfPusB/0ZBGnIRwgTP5p73opBkEYECFnizY/rSNOIAUEsfvhkdS9fbn340bED8RbHdZRpRIEgFn90e/jgOHu15mSPtzmuI0wjDgSx+Efb2eP97Gz1g4/zfywtdb8ZaITKyqLApEyEQcwp+P6rvdx6/nV+XCwz0j1e2R3XUaURDYJyj//ph+Oj7eHWfvbdXrHrk4pXobY1VgTxUH9+a3PtbO3V6ub7Gal4/bttmoJHl/NAyDid657solfw6HIeCBHirQ/nadKICsFffPU0LIZ6YgR78fXTsDi4o0XwFz+arBLiaRHsxY+8Y6gnRnAXX12WgXhyBHPx9eU4DPXUCN7iJy7DQjwtgrX4ycvvEE+LYCx++mkZiKdF8BU/c7cNxNMiOIovj+Bn77KCeFoEQ/FV7bjxPyzynMsbCDuGe/Fq4nvzPOfyBsKO4XyoV5ffQrwbBEfxk+/vGOodITiKb7x7HuJpEQzFNz81AfG0CH7iW56WgXhaBDvxbU9JQTwtgpv41qfjIJ4WwUn8xOc2NHk6YESDYCR+cXEZiKdFcBKvFhUZgXhaBCPxi5+WgXhaBB/xHZMeQDwtgo14DyXAmXQ5DwQX8Z2TnEA8LYKJ+O7JbSCeFsFDfI9JjSCeFsFCfJ/JrCCeFsFBfK9JzCCeFsFAfL/asBBPiwgvvmdtGYinRQQX33eWE4inRYQWr/pOdgHxtIiw4jVqCkE8LSKo+N67u2GeDhjRIEKK15p7HuJpEQHFV5NZQXwYRDjx9SQnDvN0wIgGEUx8gBLgTLqcByKU+BAlwJl0OQ+Ef/GNT7+7ydMBIxqEd/FTT787ztMBIxpEEPEmNYUgnhYRYqgPVQKcSZfzQAQ4uDOrIQbxtAj/4sPVfmfS5TwQvsVrXJaxz9MBIxqEZ/FBS4Az6XIeCL/iLUqEQjwtwqt4m9KwEE+L8CneqiQwxNMiPIq3KwUN8bQIf+LDlwBn0uU8EN7EW3qHeGKEW/GXoXT+M4J16Ozxtvs79nhqhJ+h3t47xBMjvIinqAEO8bQIH+KV5G2NFeFBvBK9rbEinIsvL8cJ3tZYEa7FK6pEIZ4W4Vi8IksU4mkRbsUTfmyzRIeyCR5phM1C65M76+DR40zSgHjvwSONlMQj2ATEJxoQn2hAfKLhT/zwyepevtz68KNjb222ZlEug2cRsi/8iT+6PXxwnL1a89bggiyqZegsgvaFP/GPtrPH+9nZ6gcfe2uyNYtqGTqLoH3hSfz3X+3lW5p/nR+H7fIqi+ordBZB+8KT+J9+OD7aHm7tZ9/tFb/u4aLKolqGziJoX/gb6s9vba6drb1a3XzfW5OtWRTL8FkE7QucziUaEJ9oQHyiAfGJBsQnGpGLf/bG8ntTL1x8O/rmYGPixbsvstPrWfZwo1rOQC7u7m5U6x7M/khuxC3+5bUs29mobB9m2f++zU5vZtmL7OKw/PFh9Ytw8bwQ/9pG/l+r5ehnxX+sf1x8V6w7ZkmPuMVXe+jpymcrn+Z/dt/dufH0+qev3z+99vnK7sbT/KWvVz57+/Tt3au5+Hd/9yIXXy6z7OnK5yvFfxz9eHej+O7p9fLvkvUi9KbZRgriH36Z7fxhIx+wV+6/OL2Zv3bxTeHyIH/pzjt//eTKl+VQf/P0ei6+XJYr5qtkO6Mf727kjKxYt2ZBPOso3rKf3qxlHT7/+lopfuf+87uV+PU/H36zPhKf7SxvVMtS/MN7+Z/RjwvxF/+GeDmx8/rvr2Uv37xz7aDc4+/cOL26vpEdvLN+5V4p/j9v3rv28s17V0vxP/92o1rmvy1X1n+Ty385+vHuRs4o161ZEB9nRHT43hIQ3xjPvgidgeuA+EQD4hMNiE80ID7RgPhE4/8fn6NTNHZGowAAAABJRU5ErkJggg==" /></p>
</div>
<div id="using-nn2poly-1" class="section level3">
<h3>Using nn2poly</h3>
<p>After the NNs have been trained, we can directly call
<code>nn2poly</code> on the <code>luz</code> model.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Polynomial for nn_uncon</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>final_poly_uncon <span class="ot">&lt;-</span> <span class="fu">nn2poly</span>(<span class="at">object =</span> fitted_uncon,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                      <span class="at">max_order =</span> <span class="dv">3</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co"># Polynomial for nn_con</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>final_poly_con <span class="ot">&lt;-</span> <span class="fu">nn2poly</span>(<span class="at">object =</span> fitted_con,</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>                      <span class="at">max_order =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>We can visualize the polynomial predictions versus NN predictions</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co"># Obtain the predicted values for the test data with our two polynomials</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>prediction_poly_uncon <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> final_poly_uncon, <span class="at">newdata =</span> test_x)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>prediction_poly_con <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> final_poly_con, <span class="at">newdata =</span> test_x)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_nn_uncon, <span class="at">y_axis =</span>  prediction_poly_uncon, <span class="at">xlab =</span> <span class="st">&quot;NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Polynomial prediction&quot;</span>) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Polynomial for nn_uncon&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>nn2poly<span class="sc">:::</span><span class="fu">plot_diagonal</span>(<span class="at">x_axis =</span>  prediction_nn_con, <span class="at">y_axis =</span>  prediction_poly_con, <span class="at">xlab =</span> <span class="st">&quot;NN prediction&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Polynomial prediction&quot;</span>) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">&quot;Polynomial for nn_con&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABRFBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6AGY6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkLZmkNtmtrZmtv9ubo5uq8iObm6Obo6Ojo6Oq8iOq+SOyOSOyP+QOgCQOjqQOmaQZjqQZmaQZpCQkGaQkJCQkNuQtraQttuQtv+Q29uQ2/+rjm6rjo6rjqur5P+2ZgC2Zjq2Zma2kDq2kGa2tma2tpC2tra2ttu229u22/+2/7a2///Ijm7Ijo7IjqvIq47IyMjI5P/I///bkDrbkGbbkJDbtmbbtpDbtrbbttvb27bb29vb2//b/9vb///kq47kq6vkyMjk5OTk///r6+v/AAD/tmb/tpD/yI7/25D/27b/5Kv/5Mj/5OT//7b//9v//+T///9FAhnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAVJElEQVR4nO2d/X/cxBGHFYpbJyQYGkpIqA0BkwYSWl7sxElI40KdNNhOG0ogBmy5NjHx6f//vdJJpzvp9LJa7WpnZ77ziWXfWXludh/rXdoJIoTICFwngHATEC80IF5oQLzQgHihAfFCg6X4498HQfC75+mLl3/cqp8z/2X2w50za7aTIxI8xZ+Lpe8upS8axeeRzqU2L4tgLf5OELyayLyzHB1fOF78fbIWGL93/NobwdKd+GViejJX/B/vBK9sjV/uLr4Sv07/S/Yf09hNViUpY/Zt/4Kn+HRVf/hqrHI5Vnp8Idpdjv8aTq+vpe8d/2Hr5RvL+S/j9/MlPp1h99UxZ/xf0mlGjv+kdhdTxszbHgZP8efGS+LuchQdLsUyTz/+51hwdHctfS+R/fFWKj5ZiM9MxaczpNuJ9L+k05R8uJRzZ9/2MDiLz5f4aPfSUmYxW+JnxMeOK5b4GvEJ+TCYMCCeWGTip1vvl2+uZRazbfyM+Hi7cObt5enOXbqNrxGfrB6y3QCI9yAmfwmIPESI3+1/dD7eXwwYHeWLEI+YD4gXGhAvNCBeaCiIP6iIyjc7BhjGGUoIiOfHgHihDIgXyoB4oQyIF8qAeKEMiBfKgHihDIgXyoB4oQyIF8qAeKEMiBfKgHihDIgXyoB4oQyIF8qAeKEMiBfKCAKVz4F4bozkmQ+Fz4F4bgyIl8rAql4oAzt3QhkQL5QB8UIZEC+UAfFCGRAvlAHxQhkQL5QB8UIZEC+UAfFCGRAvlAHxQhkQL5QB8UIZEC+UAfFCGRAvlAHxQhkQL5QB8UIZvcX/ayeKRo9XtiHeL0ZP8aP1lVj83rXR7f0oWlhoXycg/ItK8fuPYvEPN6LkG5Z4jxi9V/WJ8fgL4j1jlBDVD9a0id/bGN2CeL8YRUTNo3TN4o9WT66ur0YQ7xWjt/hCWEoSDPOM3qt6iPeTgRM4QhkQL5QB8UIZEC+UAfFCGRAvlAHxQhkQL5QB8UIZEC+UAfFCGRAvlAHxQhkQL5QB8UIZEC+UAfFCGRAvlAHxQhkQL5QB8UIZEC+UoYIIQ4hnx1BAhFjiGTLaESFW9RwZrYjwAOI5MtoQ4XgmiGfHaEaEYToTxLNjNCLCyUwQz47RhAjzmSCeHaMBEU5ngnh2jHpEODMTxLNj1CHCcHYmiGfHqEGExZkgnh2jGhGWZoJ4doxKRFieCeLZMaoQZe8Qz5AxjwjnvEM8Q8YcYl47xHNklBFV3iGeIaOEqPQO8QwZRUS1d4hnyJhFVOzWZTNBPDvGDKJOO8RzZEwR9d4hniEjRzR4h3iGjAmiyTvEM2SkiNrdumwmiGfHGCOatUM8R0aCaPMO8QwZkYJ3dfEIjyJUnRFLPCdGy25d9jkQz40RKiEgnhsjVENAPDNGqIiAeF6MUBUB8ZwY6W4dxEtjhB0QEM+HkT8BrfQ5EM+FMX0CWulzIJ4JY+YJaKXPgXgWjNmzdRAvh1E4SQvxYhilJ6CVPgfi/WeUn4BW+hyI954x9wS00udAvOeM+YuwEC+BUXHtHeIFMCqfgFb6HIj3mVH9BLTS50C8x4yaJ6CVPgfivWXU3VsH8bwZtbdUQjxrRsMT0EqfA/F+MpqegFb6HIj3ktH4BLTS50C8h4zmRyYgniuj5UkZiGfKaH0CWulzIN43RvsT0EqfA/GeMRSegFb6HIj3iqHyJCzE82OoPAAN8fwYSt4hnh1DzTvEc2Moeod4XgylAU7U04B4TxjK2iGeFaODd4hnxOjiHeL5MDp5h3guDPXdug5pQDx5RkftEM+E0dk7xLNgdPcO8RwYGt4h3n9G1926DmlAPGGGlnaI956h6R3iPWfoeod4vxna3iHeZ4bebl2HNCCeJKOHdoj3mNHLO8R7y+jnva/40eOV7Xh664MP9yF+UEZP733F710b3d6PXqyOXywstK8TEEYiVC4aZyCqxD/ciB7tREcr7380fqn9p2Xiz5MVIwiaftt3cVdNo158bD3+d7KfTCHeHCMImsyrFY0zkEa9+L2N0a2d6KftZNGHeHOMRvGKReMMpFEv/uTq+urR6ouV9fewqjfKaPROQHwptD/BRJYyGKFy0TgDaUA8GUZoKg+Ip8No3pMfR5eicbppzM4E8QMwmvfkx9GpaJxmGoWZIH4ARrv4bkXjNNMozATxQzBavM9chIV4QYzZs3UQL4fRvWicgTQg3jlDo2icgTQgfihG3WZep2hcjzTymSB+GEbNjv3cvXUQz4xRLX7+IizEc2OoeYd4CQztonEG0oB4dwz9onEG0oB4V4yaRyYgnjmj7t46iOfN6Fc0zkAaEO+E0bNonIE0IN4Fo2/ROANpQPzwjMYnYSGeLaP5kQmI58owUTTOAALiLTEUL8bZyAPiHTLq7rIzUzTOAALi7TBqLsYZKhpnAAHxlhiKF+Ns5KEj/vSTxcWzWxBvhWGuaJwBREn88RdY4m0xDBaNM4AoiX9589mzHyDeBsNk0TgDiPKqfvPBZ/94DvHGGcrj1rkSf/3S2xewxBtnqA9w4nAb/wQ7d/0YyQ59cafedNE4A4iy+MvPT29AfC9GkMX0feNF4wwgSuKjpxfPrmFV34sxJ9580TgDiLL4Z9ir780oruo7DkfsRvyzHzc3N7FXb5LRddw6N+J/vX9lc/NjbOPNMewUjTOAKIo/TcR/jVW9MYalonEGEOVt/L21/7wL8aYYtorGGUCUxOM43iBDq8oEjuO9Z+gNR+zsOP7SO99gVW+CYbNonAFEWTyO4w0xrBaNM4AoisdxvCmG3aJxBhBF8V8txnEO2/jOkZ6oyxk9ioe52rmLj+X+DfFdIzs1P2H0qTLhSvyVCHv13aMo3n7ROAOIkvjo6cXz2KvvHMHsqn6AonEGECXxp58s/hV34HSNYFb8EEXjDCDKq/ovnqw9qbwgbylJDoxgRnyfmrB98+iEKIu/fP9LXJ3rFtO7LiIDxcNcbeOP687cIeoi8Z79OGStQCORi//187pZLP11cmDkd9sYKBboaol/+Q5O2WqHiWKBzvbqNx/glK1ehEaKBToTf/21t1/HEq8apVtpibRF+0YMHM4pxsxN1KHLPHQQ89v4729+XbWut5Sk14ypeGPFAt1t45Oout3SUpJeM3Lx5ooFOjuOrw1LSXrImNmwpz/mZ+uItAXirTDmRrcxWjPOkfjTZ7j1qi1KD0TOnrUh0hYN8d9v4tartmh4IpJIW/SO4xcXX8FFmoYoPQpruligy8uyuPWqKQreSxdhibRFS/y7h8s4gdMYQfno3VEePREl8dF3P97Ds3MtUeedSlu0xGOvXjmsFAt0JB4PVKiHnWKB7k7gYIlXisp764i0RWvn7q1Ll97BEt8a1mrGubwsWx2WkvSTUXOPFZG2aJ3A+QtGr24Pi8UCscQTZtgsFujwRgzs3DVHwyMTRNqitarH6NUtYblmnLuLNBi9ei6Uh6Ul0hbdbTxGvSpG7cW4gfMwiyiLx6hXpShejXOXh2lESTxGry5G4ep765OwRNqitY1HFarZ6LK428zDAqJiG18dlpKkzAg6eqfSFq3jeFShyqPhHqtB87CDKK/qcVk2j+5VJoi0RWtVf6l60HKh4ic/Kg5wQqQtetfjn168XLmut5QkXUa3zbu9PCwhyuJP71+8cr/qrjtLSdJl1N9TOWwelhDlVX0yAs7p3yD+oOGeyoHzsIMoiscjVOOoe0Rq6DxsIoriv98UfnUuSEuHaRYPI9IWXJ3rzEiP3DV26wznMQCivI2XfXUuO2WjO34Zkbbg6lx3Ru0T0APnYR9REi/76lztiAcD5zEEoij+f4uL1doFiJ8rAe2kWKAj8fe2Xl4WKr5XCWiDeUD8wAwD3qm0RUP83c8enJN6da7zRVhLeQyEKIoXPQaO9uG74TyGQRTFN4SlJCkxlO+ts5zHIAiIn2M4rRkH8cMx0lV8zuhRbcB9W9QREJ/tzk8YjosFQvwwjOySTC6+XxEpIv0B8a0RBPl5mzHDfc04iB+EMfU+ZhCoGUdA/OjxyvZkyln8tBJ07yJSRPqjp/i9a6Pb+9k0WlhoXyf4F+niPnnlXdE4A1El/uFG9Ggnm0Ysl/huT0Tay8M0o+cSH/vO/3EUHxS9e90WDUS9+L2N0a2dbMpQfPnJOJ/booOoF39ydX31aDWZRmzFT16EfrdFB1EvvhSWknTCGBunWSwQ4i0yKu+x8rQt2giB4quLi/jZFn2EePHEasZBvD1G9QAnfrZFHyFOfN3ANj62pQ9CkvjJA5GVRaQ8a0tvhCDx+QORlbdU+tWW/ghp4g/qbqH2qy39EeLE51G6KONXW/ojxIonWiwQ4s0y2ge68KctZhAyxCsMdOFNWwwhBIlvHujCm7YYQogQX74q4yqPgRgQn4XSE9CetMUYQoD40sU42sUCId4cQ23AAz/aYg7BX7ziQBdetMUggrl49QFO6LfFLIK3+OqbbYbPY1gGxNdfhB04j2EZ0sXnl9/Tl37UjIP43oxMueqo86TbYgHBXnwWrU/GkW6LBQRv8R3GrSPdFgsIpuJLT0T6UywQ4nsxSt6d5eGGIVZ8UbviQBdE22INwVC8lneibbGH4CdezzvNtlhEsBMfZLdZpa/UBzih2BabCJbi8xf+1YyDeF1Gt6N3e3k4ZAgUr3EYZyUPtwx54oOCeC+LBUJ8d0ZQ8N513DpabbGP4CNe/Z4Lu3m4ZwgUn7/jbc04iO/IUL63znIeFBiSxPdczxvLgwRDnPjsld5wxHTaMgyCkfjshd814yBePYIg0i/5bjAPMgwh4gsXZfSrTJBoixmGIPGaZ+uM5kGHIUF8urRHmfg+VSbct8UYQ4D4bFGP0lU9h5pxEN8e0+EKU0a/ojJEpEF8a2Q7dZOacUyKBUJ8a8wcuicMJsUCIb4tZk/RRgaKhxGRRk88qUgP4KavJdYKNBKeLfGl8Q761wbVzIMog++qvuydSIdTYfAVX34SlkiHU2EwFj97UYZXsUCIr4vCmPPZ5p1Ih1NhsBRfHOci260j0uFUGALE8ysWCPF1UTWwDZEOp8LgKH6+JqybPEgzuIkvnbbhWTMO4ueiYcADIh1OhcFTfPaKa7FAiC9FsZgQ32KBEF+IoHQUx7dYIMTPRv1u3bB5eMLgKn7+IiyRDqfC4CF+vva3mzw8YrAQXzqIi72XrtIMlIdPDA7ig5L4MCxdpRkoD68YDMRn0mdX8xBvBuGB+OnLMH1v+Dz8YjAQL69YIMQfTHbo85ciigVC/EF58y6jWCDEB8Udeik148SLz/fns3EqdRgm8vCR4b349HsylVMsULz4ynvrujJM5OEhg4v49idhiXQ4FYbX4qcH8LJqxkF8l3GsiHQ4FQYL8dKKBUJ80GEgKyIdToXhq/jpcZzqACdEOpwKw1PxnXbrLObhL8N38eoDnBDpcCoMz8XLLBYI8UKLBUoTP3uCtstunek8WDA8El++kU5uzTjZ4ruOW0ekw6kwPBJ/0Ms7lQ6nwvBJ/GyILhYoV7zOcMREOpwKwxPxvXbrDObBh+GH+MrxyzoGkQ6nwvBQPIoFyhEf9fdOpcOpMDwRn/+kX2WCSIdTYXgmHjXjTDFoi5+s4SeMPlUmiHQ4FQZp8fk+XcZAsUBzDJ/Eo1igQQZp8YVVfd/iYUQ6nAqjp/jR45XteHrrgw/3DYsvnKuLDBSRItLhVBg9xe9dG93ej16sjl8sLLSvE1SjWDIOReNcRpX4hxvRo53oaOX9j8Yvzf11Fk/SRgaKxhFZ0qgw+izxP3+7HVuP/53sJ1Oj4ntefDeXB1dGH/G//bK/tzG6tRP9tJ0s+sbEl4esClEs0Dyj5zb+5Or66tHqi5X194yt6oOKe+uIdBYnBrnDuaAsPuzOqAwwuiMGFz/zGsUC7TDIiT+outmGSGdxYlASPz8O6eRsHZHO4sQgJH5+5GHUjLPHoCx+evROpLM4MQiJr6wB3ZVRH2B0RwwkvhgoFmiVQVV88SIskc7ixCAqHjXjbDNoii9flCHSWZwYJMWjWKB9BkXxKBY4AIOe+Kp764h0FicGEfENNWGVGS0BRneEdfFt4xUS6SxODGLia+6xItJZnBg0xB+0jFNJpLM4MYiIH0f9IxNEOosTg5B41IwbkkFHfNMt1EQ6ixODjHgUCxyWQUU8igUOzHAsfrI3j2KBQzPcilcdfZxIZ3FiDC2+eHtVKr79yTgincWJMbD48g2Vat6pdBYnhmPxBygW6IjhdlWvOsAJkc7ixHC8V4+aca4YbsWrDnhApLM4MZyKR7FAdwyX4lEs0CHDnfgu49YR6SxODGfiUTPOLcOV+G7jWBHpLE4MR8fxKBbomuHmzB2KBTpnuBDffThiIp3FieFgVY+acRQYw+/c6QxPSqSzODHsi68f4MRwlmAYR/QR37MGdIcswTCOMCZet8oEkc7ixBh0VY+acXQYQ+7c6Y86T6SzODEGFI9igZQYw4lHsUBSjKHE9yseRqSzODEGEo+acdQYw4jvW0yISGdxYgwiHsUC6THMiq8OFAv0OzSX+L41YZX/PMEwjugjHjXjaDJsiw+pNBQMDYS+eBQLpMqwKx7FAskybIoPUSyQLsOieNSMo8ywJ35yFEekoWBoIHTEo1ggbYYt8SgWSJxh55RtaPgs7YJZnHbIzEP7XH3/kNnh9QHxA4fMPByKR7gMiBcaEC80IF5oOBI/eryyHU9vffDhvpsECmmMpwTyGLI7HInfuza6vR+9WHXz6aU00qn7PAbtDkfiH25Ej3aio5X3P3Lz+YU00qn7PAbtDhfif/52O25m/O9k33GPp2mk/9znMWh3uBD/2y/7exujWzvRT9vJ37rDSNNIp+7zGLQ7HK3qT66urx6tvlhZf8/N5xfSSKZO03DRHTicExoQLzQgXmhAvNCAeKEhUPzhUhTdW0unpV+d3rw/fuv0hyflX3ELieLPrEV319Jp8vpZ/PU8dh37/vHm88R6dLgcjb+nv2QZEsX/+U/PY/HjaRTtnn9w/qvXPj88//fLh5fvn7u/lvy0uzT+fv6r+Ou563zthETxy4dLsfjxNIridfrdS/HXlc3rZ7eSVf29rWSWJ8n3+BenNyGeS8Tr8buLa+l0LP7ep/HXl8++u5GJP/0vxHOMWPnLN9fSabyqP3vj9Vj+8VufXoi/4lX98VufvHt47kby/cITiGcb7Hffa0K8+KffuM7ATYgXLzUgXmhAvNCAeKEB8ULj/0+187kFMPPZAAAAAElFTkSuQmCC" /></p>
<p>We can clearly see how the constrained NN allows to obtain a close
approximation with <code>nn2poly</code> while the polynomial obtained
for the unconstrained one is not a good representation.</p>
<p>We can also represent the obtained polynomial coefficients and
observe how the constrained case clearly has terms <code>2,3</code> and
<code>1</code> with the same sign as the original polynomial while the
rest are close to 0.</p>
<blockquote>
<p><em>Note</em>: The coefficients values are not in the same scale as
the original polynomial due to the fact that we have scaled all the data
before training, even the response variable Y. Furthermore, as data has
been scaled to the <span class="math inline">\([-1,1]\)</span> interval,
interactions of order 2 or higher would usually need a higher absolute
value than the lower order coefficients to be more relevant</p>
</blockquote>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(final_poly_uncon, <span class="at">n =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">plot</span>(final_poly_con, <span class="at">n =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAllBMVEUAAAAAAC4AADoAAFIAAGYAOjoAOpAAZrYAujguAFI6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmOpBmZmZmkJBmtrZmtv9zkXOQOgCQOjqQOmaQkGaQtpCQ27aQ2/+RUgCRzMy2ZgC225C2/7a2///MkVLMr3PMzMzbkDrb29vb/9vb///4dm3/tmb/25D//7b//9v///89LXbfAAAACXBIWXMAAAsSAAALEgHS3X78AAANy0lEQVR4nO2diXbbuAFFWTe1WjuRki6qksloytYzVeNq4f//XAlwA0VLgFxSJPHuPWcmsgXCFK+wb0kGkiRj3wCMA+JFQbwoiBcF8aLcKv7f0DODaPWD+LEZRKsfxI/NIFr9IH5sBtHqB/FjM4hWP4gfm0G0+kH82Ayi1U+s4n/70z/GvoVABtHqJ1Lxvya/R/xV4hT/y+/+Toq/Tpziyeq9IH5sBtHqB/FjM4hWP4gfm0G0+kH82Ayi1Q/ix2YQrX5iFT8fBtHqB/FjM4hWP4gfm0G0+kH82Ayi1c+t4pmcGQmIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCiIFwXxorxPfBJE/3cLvfFO8f8NAPFTBvGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxItyzc7h44v9d5ckyYcXNzziZ88VO/vKdro+D4/42XPZTvrwvUjxp6/b8/CInz0BWf1xlWf1NtHXh8khfvYEiD88b5tUj/hICKncGapyHvGRgHhRAsTvH1+z0zeac3HhE2/+y9vxD9tWeMTPHnruREG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQL4pj5/C8Pa6arQyvhUf87GnsnDbLLH18NRuYesMjfvY0do6ft6fNorVz8cXwiJ89bopfH57W2Y4UL4Fbxj8liyz9cDXBIz4WqNWLgnhRXDu7JFl7KvWIjwXHTvr4Y7PO0kVAeMTPnrPm3JrmnAgd8fvr1XrER4JjZ2ey+uNqGRAe8bPHtbM3J0le9474WKA5JwriRXEqd+bsYOek+GvhET97zu20zgy/GB7xs6djh/F4DTp26MDRoGMnJcVL0KncMedOA5pzoiBelMpO1YqnHS8CKV4UxIvi2NmT1QvRWklzYjxehtYMnCxd0mUrQlv8jiVUKrizbBcmubOESgPHznG1zlK6bEWgOSeKO0jjmWfphEf87Dlrx6/DwiN+9rTt7BiWVaE7EYOeOwnadlJSvAruEirKeCGo1YtCO14UxIuCeFEQLwriRXHsnDZ26hXDshLUdg5PZdfN/mofDuIjoZ5X/+cmoZ++Xe61RXwkUMaLgnhRXDtsaSqEO9mSLU2F6OxsyfRqDTri2dJUA3c8ni1NhXDtsKWpEDTnRGmvncvY7kyFjngqdxpUdvbVFjgJ7XgJOineocr1j6tmrBbxkXDFzr7cFcW07neLVnjEz57Ozpb1Hjjpw/cixR+/vDRVPsRHwrkdd9vy0vbh02tZDpjvRXEV4udOx44zPFeKN7+pKwCIj4SOHacd30nxGeKjobtatpPiKeNjpFO5e+iU8afNklp9dFyzY8Sb/2jHRwiDNKLU06vZtlwLUrwoiBflbHo1M3BUcOfcmdKdOXciuO14u/MREzE0QLwoZPWiULkTheacKIgXxbFzeN4eV+xlK0Jjx4y+po+vnEI1eZI27wiQdVbLcgrVDEh8jzn5o4tP/GmzPjytM06hmjw9i88OT8nCd04B4gcnLVYzdde31PQtPgjED4zZisYUuVdAfIQUCX3/4cW8MI2sn8zL709ua6t38XbhpOeMCsQPS53Yc/Gm+/zwlItf5eWvM/v53eLNfOk6TBOcvvopYObAGce5eNuy3hnx69bgWc/iGZ2bCrn7hRFv57TvexNfrISv0nVHPO34CWA6UW8Unzo7G7wvq79eyCN+WAq/uYV7ZfVMr54Gp01l23SkLjNTsetNfCvMjTeG+KFJi8Mi6ubc4yviFXlj0Kxv8Xuy+mmxf9jaMdNzeh6dy//EiS1NJ8XOPxXu3bSGZbN0+VbW0g2P+NnTFr9jPF4Fx066MMmd8XgNHDum1ZAy504EmnOiIF6UusuWAwe1qO1wxKgWjh0OFVaCMl4UxIuCeFEQLwriRWkP0mRMtlShI57p1Rq0J11z/JgMnRQfFB7xs4fKnSjt9fFMtpTBnWx5vXR3wyN+9lDGi+KmeM/SeCc84mePu2jy+oCsGx7xs8ddJs1KGiFozomCeFFcO7skWXtWUCE+FtyVNI8/8op9Sl+9BK12vGnRMSyrQUd8z8OySRBDfkJ4k1Y7/kf/6+PbmzNcAPH3x33m+wHOpEH8RBm6OYf4iYJ4UepFk6u/DdJli/iJQooXBfGitLZCWZY7anrDI372uBMxbEsu7XeZNOInytAraRA/UVqDNK/+KZeIjwT3maf+hTSIjwVq9aIgXhR67kQhxYtSp/jPPw+ykgbxEwXxotTPPB3mFCrET5ShF00ifqKQ1YuCeFEo40WhjBeFDhxRhl40ifiJMvSiScRPlKEXTSJ+ogy+aBLx04RFk6KwaFIUmnOiIF6Us3Y8Wb0KbuXO1Oep3IngNOdWdi9bmnMaIF4UsnpRqNyJcvmZH1fVwdI7Z3oG4iPh4jM3/fa7YqQudU4wQHwkNM/c1up2ddXu+OWlHKk7fd2eh0f87Kmf+f6hOGgyKZP34dNrORvLnmBgf1vvPor42VM98/pEmuqAEjMVpxB/eN42qR7xkdBMry7NVhMxmhRvqcp5xEdCs0y6yuJL8U0Zb0F8ZDTz6hftf80mWEWt3mT6p2805+KifubHlbWcNtV62443iT5vxz9sW+ERP3vcWbYBHXeIjwUmYoiCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXBfGiIF4UxIsyGfFJED1/emGmIz44SugDxIuCeFEQL8r8xFML7IUZig+NEa6BeFEQLwriRUG8KIgXBfGiIF4UxIuCeFEQLwriRUG8KIgXJWLxweO34QO9EQ0Jxyy+94AxzRZBPOJvCI94301OvkxA/DDigx/QWCAe8WccV8nj69krxIfeZPADGouLf/y0WWe7RftVhvjQmwx+QGNx8Y8fv7xkh48vrVcZ4kNvMvgBjcXFP3749JodP29br+qa6ABdHnMIOESUY3Hxj+8fK93Nq2vhYV7clOKvhYd58b4yHmbPlVr9sq7VL89r9TB7fO14k9S77XiYPe/ruYPZg3hREC8K4kVBvCiIFwXxoiBeFMSLgnhREC8K4kVBvCg3i4e+GcSrX+TdIxox4Dxu8j4gfmoB78TU7gfuBOJFQbwoiBelH/GHp2SZJsmHl15iK2M0+GPMAz5sizng/pBhNzliwPvRi3izrDLNP5VZetEPJkbD/tETowlo5n/7xQff5IgB70gv4s1T3y8Dkt1xVXZa+L77VUz+GG2AdOEXH36T4wW8I72leIP/G20S5y0xBqX4nN0fPoakeENQ+hwp4B3pp4w/rswn2wWUYfUiPG+MgWX8cWW/SgF/O/gmRwx4P6jVi4J4UXoVn+fPC3+okQm+yRED3gFSvCiIF6W3nrvA7rMRuaWfLezT3BIw2p67sO6zEbmpny3o09wUMNqeu7DusxG5qZ8t6NPcFDDmnruA7rMRubWfzf9pbg0YX4q/oftsRG7oZwv8NDcEpOcOpgHiRdETH3eHXDB64sGCeFGExPffITdndMT33yE3a3TED9AhFzqDcIroiO+/Qy54BuEU0RE/QIdc8AzCCSIkHlwQLwriRUG8KIgXBfGiyIj/z//5fmxMSPxpUwxu7toLJZ22cjGRJbj57ATzdbXYLtr5NsrfwYTEZ3vbY1LZfYMbxTuEiNdiSuILr0a/3Q9jnZ2+/pQ8/JxbLn8+rv76ZDrGjfjTJrGHou0SO5RmKH9lrzK/yoMdP383Q23mnUX7/TJKE/Xjq33fibW8rBV7ZExJfJYuiv/Zb0D64eW0KY61rX4+rnLru/zfz1ubRPNCwXxNipyiKCpSY7E6995cmb9nf7fMqkuKWOso19V7NtYiiuoyJ/bYmJR4e7phlY3vjfhlk6/vrSWbL+S/sjpOm7WjxR6DWoq0VF+ZMqbqkiZbz39Tf2ms+CqK6rJIpRsmJd6MixV7YJgRT6NrXYovfrYvc0f5v7tiQHRp8uayTmCvzN+tZrGfi28use8XUZY1yVJ8FUVzWR17bExKvDnCNl1aJ8viua9LfcXPrvim6p+WxbBXfHlJEWsZ5XXxTuyxMS3xh4//fN6WCh3x1c/nWX1JmXc3Wf3b4qtL7PtVlNezeif22JiW+Cz9i6nfFRV7UxkvxZc/V3UuWw3Lze0fireebZpsKndvi68uKcTXUa5NPtOp3DVlfBl7bExM/L4oUs2S4n+Vadfk7+XPtpVVVPRtw8tkwmlSF8NVc+0N8XkBv6guKd4vozTNOZOyd+3mXHWZE3tkTEw83AvEi4J4URAvCuJFQbwoiBcF8aIgXpT/AccZPWPPN/RYAAAAAElFTkSuQmCC" /></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
